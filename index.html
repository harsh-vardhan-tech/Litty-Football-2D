<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Litty Football 2D - Full Match</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        body {
            background: #1a1a2e;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
        }
        #gameContainer {
            position: relative;
            max-width: 100vw;
            max-height: 100vh;
        }
        canvas {
            display: block;
            background: #2d5016;
            border: 3px solid #fff;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
        }
        #ui {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 10px;
            z-index: 10;
        }
        #controls {
            position: absolute;
            bottom: 20px;
            width: 100%;
            display: none;
            justify-content: space-between;
            align-items: flex-end;
            padding: 0 20px;
            pointer-events: none;
        }
        .joystick, .action-btns {
            pointer-events: all;
        }
        .joystick {
            width: 120px;
            height: 120px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            position: relative;
            border: 3px solid rgba(255,255,255,0.4);
        }
        .joystick-knob {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.6);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 2px solid white;
        }
        .action-btns {
            display: flex;
            gap: 15px;
        }
        .btn {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: rgba(255,100,100,0.8);
            border: 3px solid white;
            color: white;
            font-size: 16px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            active: scale(0.9);
        }
        .btn:active {
            transform: scale(0.9);
        }
        @media (max-width: 768px) {
            #controls {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <div id="gameContainer">
        <canvas id="gameCanvas"></canvas>
        <div id="ui">
            <span id="timer">5:00</span> | 
            <span style="color: #ff4444;">RED</span> <span id="redScore">0</span> - 
            <span id="blueScore">0</span> <span style="color: #4444ff;">BLUE</span>
        </div>
        <div id="controls">
            <div class="joystick" id="joystick">
                <div class="joystick-knob" id="knob"></div>
            </div>
            <div class="action-btns">
                <div class="btn" id="shootBtn">SHOOT</div>
                <div class="btn" id="passBtn">PASS</div>
            </div>
        </div>
    </div>

    <script>
        // Canvas Setup
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const FIELD_WIDTH = 1200;
        const FIELD_HEIGHT = 700;
        canvas.width = Math.min(FIELD_WIDTH, window.innerWidth - 20);
        canvas.height = Math.min(FIELD_HEIGHT, window.innerHeight - 20);
        const scale = Math.min(canvas.width / FIELD_WIDTH, canvas.height / FIELD_HEIGHT);

        // Game State
        let gameTime = 300; // 5 minutes
        let redScore = 0;
        let blueScore = 0;
        let players = [];
        let ball = null;

        // Player Class
        class Player {
            constructor(x, y, team, isHuman = false) {
                this.x = x;
                this.y = y;
                this.vx = 0;
                this.vy = 0;
                this.team = team; // 'red' or 'blue'
                this.isHuman = isHuman;
                this.radius = 15;
                this.speed = isHuman ? 3 : 2.5;
                this.color = team === 'red' ? '#ff4444' : '#4444ff';
            }

            update() {
                if (!this.isHuman) {
                    this.aiMove();
                }
                
                this.x += this.vx;
                this.y += this.vy;
                
                // Boundaries
                if (this.x < this.radius) this.x = this.radius;
                if (this.x > FIELD_WIDTH - this.radius) this.x = FIELD_WIDTH - this.radius;
                if (this.y < this.radius) this.y = this.radius;
                if (this.y > FIELD_HEIGHT - this.radius) this.y = FIELD_HEIGHT - this.radius;
                
                // Friction
                this.vx *= 0.85;
                this.vy *= 0.85;
            }

            aiMove() {
                // Simple AI: Chase ball
                const dx = ball.x - this.x;
                const dy = ball.y - this.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist > 50) {
                    const angle = Math.atan2(dy, dx);
                    this.vx = Math.cos(angle) * this.speed * 0.5;
                    this.vy = Math.sin(angle) * this.speed * 0.5;
                } else {
                    // Near ball, try to kick toward goal
                    const goalX = this.team === 'red' ? FIELD_WIDTH - 50 : 50;
                    const goalY = FIELD_HEIGHT / 2;
                    const goalDx = goalX - ball.x;
                    const goalDy = goalY - ball.y;
                    const goalAngle = Math.atan2(goalDy, goalDx);
                    
                    if (dist < 30) {
                        ball.vx = Math.cos(goalAngle) * 8;
                        ball.vy = Math.sin(goalAngle) * 8;
                    }
                }
            }

            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x * scale, this.y * scale, this.radius * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = this.isHuman ? '#ffff00' : '#fff';
                ctx.lineWidth = this.isHuman ? 3 : 2;
                ctx.stroke();
            }
        }

        // Ball Class
        class Ball {
            constructor(x, y) {
                this.x = x;
                this.y = y;
                this.vx = 0;
                this.vy = 0;
                this.radius = 10;
            }

            update() {
                this.x += this.vx;
                this.y += this.vy;
                
                // Wall bounce
                if (this.x < this.radius || this.x > FIELD_WIDTH - this.radius) {
                    this.vx *= -0.7;
                    this.x = this.x < this.radius ? this.radius : FIELD_WIDTH - this.radius;
                }
                if (this.y < this.radius || this.y > FIELD_HEIGHT - this.radius) {
                    this.vy *= -0.7;
                    this.y = this.y < this.radius ? this.radius : FIELD_HEIGHT - this.radius;
                }
                
                // Friction
                this.vx *= 0.98;
                this.vy *= 0.98;
                
                // Check goals
                this.checkGoal();
            }

            checkGoal() {
                const goalTop = FIELD_HEIGHT / 2 - 80;
                const goalBottom = FIELD_HEIGHT / 2 + 80;
                
                // Left goal (Blue defends)
                if (this.x < 30 && this.y > goalTop && this.y < goalBottom) {
                    redScore++;
                    this.reset();
                    updateUI();
                }
                // Right goal (Red defends)
                if (this.x > FIELD_WIDTH - 30 && this.y > goalTop && this.y < goalBottom) {
                    blueScore++;
                    this.reset();
                    updateUI();
                }
            }

            reset() {
                this.x = FIELD_WIDTH / 2;
                this.y = FIELD_HEIGHT / 2;
                this.vx = 0;
                this.vy = 0;
            }

            draw() {
                ctx.fillStyle = '#fff';
                ctx.beginPath();
                ctx.arc(this.x * scale, this.y * scale, this.radius * scale, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#000';
                ctx.lineWidth = 2;
                ctx.stroke();
            }
        }

        // Initialize Game
        function initGame() {
            // Create ball
            ball = new Ball(FIELD_WIDTH / 2, FIELD_HEIGHT / 2);
            
            // Create human player (Red team, forward)
            const humanPlayer = new Player(FIELD_WIDTH / 4, FIELD_HEIGHT / 2, 'red', true);
            players.push(humanPlayer);
            
            // Red team AI (10 players)
            const redPositions = [
                [150, 350], [200, 250], [200, 450], // Defense
                [350, 200], [350, 500], [350, 350], // Midfield
                [500, 250], [500, 450], [500, 350], [600, 350] // Forward
            ];
            redPositions.forEach(pos => {
                players.push(new Player(pos[0], pos[1], 'red', false));
            });
            
            // Blue team AI (11 players)
            const bluePositions = [
                [1050, 350], [1000, 250], [1000, 450], // Defense
                [850, 200], [850, 500], [850, 350], // Midfield
                [700, 250], [700, 450], [700, 350], // Forward
                [600, 250], [600, 450] // Strikers
            ];
            bluePositions.forEach(pos => {
                players.push(new Player(pos[0], pos[1], 'blue', false));
            });
        }

        // Draw Field
        function drawField() {
            // Grass pattern
            for (let i = 0; i < FIELD_WIDTH / 80; i++) {
                ctx.fillStyle = i % 2 === 0 ? '#2d5016' : '#355e1a';
                ctx.fillRect(i * 80 * scale, 0, 80 * scale, canvas.height);
            }
            
            // Center line
            ctx.strokeStyle = '#fff';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(FIELD_WIDTH / 2 * scale, 0);
            ctx.lineTo(FIELD_WIDTH / 2 * scale, canvas.height);
            ctx.stroke();
            
            // Center circle
            ctx.beginPath();
            ctx.arc(FIELD_WIDTH / 2 * scale, FIELD_HEIGHT / 2 * scale, 80 * scale, 0, Math.PI * 2);
            ctx.stroke();
            
            // Goals
            const goalTop = (FIELD_HEIGHT / 2 - 80) * scale;
            const goalBottom = (FIELD_HEIGHT / 2 + 80) * scale;
            const goalWidth = 30 * scale;
            
            // Left goal
            ctx.fillStyle = 'rgba(255,255,255,0.3)';
            ctx.fillRect(0, goalTop, goalWidth, goalBottom - goalTop);
            ctx.strokeRect(0, goalTop, goalWidth, goalBottom - goalTop);
            
            // Right goal
            ctx.fillRect(canvas.width - goalWidth, goalTop, goalWidth, goalBottom - goalTop);
            ctx.strokeRect(canvas.width - goalWidth, goalTop, goalWidth, goalBottom - goalTop);
        }

        // Update UI
        function updateUI() {
            document.getElementById('redScore').textContent = redScore;
            document.getElementById('blueScore').textContent = blueScore;
            const mins = Math.floor(gameTime / 60);
            const secs = gameTime % 60;
            document.getElementById('timer').textContent = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }

        // Controls
        const keys = {};
        const humanPlayer = () => players.find(p => p.isHuman);

        window.addEventListener('keydown', e => {
            keys[e.key] = true;
            if (e.key === ' ' || e.key === 'Enter') {
                shootBall();
                e.preventDefault();
            }
        });
        
        window.addEventListener('keyup', e => {
            keys[e.key] = false;
        });

        function handleKeyboardInput() {
            const player = humanPlayer();
            if (!player) return;
            
            if (keys['ArrowUp'] || keys['w'] || keys['W']) player.vy = -player.speed;
            if (keys['ArrowDown'] || keys['s'] || keys['S']) player.vy = player.speed;
            if (keys['ArrowLeft'] || keys['a'] || keys['A']) player.vx = -player.speed;
            if (keys['ArrowRight'] || keys['d'] || keys['D']) player.vx = player.speed;
        }

        // Touch Controls (Mobile)
        let touchActive = false;
        let touchStartX = 0;
        let touchStartY = 0;

        const joystick = document.getElementById('joystick');
        const knob = document.getElementById('knob');

        joystick.addEventListener('touchstart', e => {
            e.preventDefault();
            touchActive = true;
            const rect = joystick.getBoundingClientRect();
            touchStartX = rect.left + rect.width / 2;
            touchStartY = rect.top + rect.height / 2;
        });

        joystick.addEventListener('touchmove', e => {
            if (!touchActive) return;
            e.preventDefault();
            const touch = e.touches[0];
            const dx = touch.clientX - touchStartX;
            const dy = touch.clientY - touchStartY;
            const dist = Math.sqrt(dx * dx + dy * dy);
            const maxDist = 35;
            
            const limitedDx = Math.max(-maxDist, Math.min(maxDist, dx));
            const limitedDy = Math.max(-maxDist, Math.min(maxDist, dy));
            
            knob.style.transform = `translate(calc(-50% + ${limitedDx}px), calc(-50% + ${limitedDy}px))`;
            
            const player = humanPlayer();
            if (player && dist > 5) {
                player.vx = (limitedDx / maxDist) * player.speed;
                player.vy = (limitedDy / maxDist) * player.speed;
            }
        });

        joystick.addEventListener('touchend', e => {
            e.preventDefault();
            touchActive = false;
            knob.style.transform = 'translate(-50%, -50%)';
            const player = humanPlayer();
            if (player) {
                player.vx = 0;
                player.vy = 0;
            }
        });

        document.getElementById('shootBtn').addEventListener('touchstart', e => {
            e.preventDefault();
            shootBall();
        });

        document.getElementById('passBtn').addEventListener('touchstart', e => {
            e.preventDefault();
            shootBall(0.5);
        });

        function shootBall(power = 1) {
            const player = humanPlayer();
            if (!player) return;
            
            const dx = ball.x - player.x;
            const dy = ball.y - player.y;
            const dist = Math.sqrt(dx * dx + dy * dy);
            
            if (dist < 40) {
                const angle = Math.atan2(dy, dx);
                ball.vx = Math.cos(angle) * 12 * power;
                ball.vy = Math.sin(angle) * 12 * power;
            }
        }

        // Collision Detection
        function checkCollisions() {
            // Ball-Player collisions
            players.forEach(player => {
                const dx = ball.x - player.x;
                const dy = ball.y - player.y;
                const dist = Math.sqrt(dx * dx + dy * dy);
                
                if (dist < ball.radius + player.radius) {
                    // Push ball away
                    const angle = Math.atan2(dy, dx);
                    const overlap = (ball.radius + player.radius) - dist;
                    ball.x += Math.cos(angle) * overlap;
                    ball.y += Math.sin(angle) * overlap;
                    
                    // Transfer momentum
                    ball.vx += player.vx * 0.3;
                    ball.vy += player.vy * 0.3;
                }
            });
            
            // Player-Player collisions (simple)
            for (let i = 0; i < players.length; i++) {
                for (let j = i + 1; j < players.length; j++) {
                    const p1 = players[i];
                    const p2 = players[j];
                    const dx = p2.x - p1.x;
                    const dy = p2.y - p1.y;
                    const dist = Math.sqrt(dx * dx + dy * dy);
                    
                    if (dist < p1.radius + p2.radius) {
                        const angle = Math.atan2(dy, dx);
                        const overlap = (p1.radius + p2.radius - dist) / 2;
                        p1.x -= Math.cos(angle) * overlap;
                        p1.y -= Math.sin(angle) * overlap;
                        p2.x += Math.cos(angle) * overlap;
                        p2.y += Math.sin(angle) * overlap;
                    }
                }
            }
        }

        // Game Loop
        function gameLoop() {
            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw
            drawField();
            
            // Update
            handleKeyboardInput();
            
            players.forEach(p => p.update());
            ball.update();
            
            checkCollisions();
            
            // Draw entities
            players.forEach(p => p.draw());
            ball.draw();
            
            requestAnimationFrame(gameLoop);
        }

        // Timer
        setInterval(() => {
            if (gameTime > 0) {
                gameTime--;
                updateUI();
            } else {
                // Game over
                const winner = redScore > blueScore ? 'RED' : blueScore > redScore ? 'BLUE' : 'TIE';
                alert(`Game Over! ${winner} WINS! Score: RED ${redScore} - ${blueScore} BLUE`);
                location.reload();
            }
        }, 1000);

        // Start Game
        initGame();
        updateUI();
        gameLoop();

    </script>
</body>
</html>
