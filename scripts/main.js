// Generated by Construct, the game and animation creation tool
// Visit: https://www.construct.net

"use strict";window.i=class{constructor(t,s){this.h=t,this.o=s,this.l=!1,this.u=()=>this.m()}v(){}_(t,s,i,e){this.h.S(this.o,t,s,i,e)}O(t,s,i,e){return this.h.P(this.o,t,s,i,e)}R(t,s,i){this.h.C()?this._(t,s,i):this.h.M()._OnMessageFromDOM({type:"event",component:this.o,handler:t,dispatchOpts:i||null,data:s,responseId:null})}I(t,s){this.h.T(this.o,t,s)}A(t){for(const[s,i]of t)this.I(s,i)}G(){return this.h}F(){return this.o}L(){this.l||(this.h.D(this.u),this.l=!0)}W(){this.l&&(this.h.U(this.u),this.l=!1)}m(){}},window.H=class{constructor(t,s){this.B=t,this.V=s,this.j=-1,this.N=-1/0,this.$=()=>this.Y(),this.X=!1,this.J=!1}K(t){this.J=!!t}Z(){if(-1!==this.j)return;const t=Date.now(),s=t-this.N,i=this.V;s>=i&&this.J?(this.N=t,this.tt()):this.j=self.setTimeout(this.$,Math.max(i-s,4))}tt(){this.X=!0,this.B(),this.X=!1}st(){this.X||(this.it(),this.N=Date.now())}Y(){this.j=-1,this.N=Date.now(),this.tt()}it(){-1!==this.j&&(self.clearTimeout(this.j),this.j=-1)}et(){this.it(),this.B=null,this.$=null}};{class t{constructor(t){this.nt=t,this.ht=!1,this.ot=!0,this.rt=-1,this.ct=-1,this.lt=-1}ut(t){this.ot=!!t}dt(){return this.ot}wt(){return this.ht}ft(){this.ht=!0}yt(){return this.rt}gt(t){this.rt=t}vt(){return this.ct}bt(t){this.ct=t}_t(t){this.lt=t}St(){return this.lt}kt(){return this.nt}}window.Ot=class extends self.i{constructor(t,s){super(t,s),this.Pt=new Map,this.Rt=!0,this.A([["create",t=>this.Ct(t)],["destroy",t=>this.Mt(t)],["set-visible",t=>this.xt(t)],["update-position",t=>this.It(t)],["update-state",t=>this.Tt(t)],["focus",t=>this.At(t)],["set-css-style",t=>this.Gt(t)],["set-attribute",t=>this.Et(t)],["remove-attribute",t=>this.Ft(t)]]),this.Lt("get-element",(t=>t))}Dt(t){this.Rt=!!t}Lt(t,s){this.I(t,(t=>{const i=t.elementId,e=this.Wt(i);return s(e,t)}))}Ut(t){for(const[s,i]of t)this.Lt(s,i)}Ct(s){const i=s.elementId,e=this.Ht(i,s),n=new t(e);this.Pt.set(i,n),e.style.boxSizing="border-box",e.style.display="none",n.ut(s.isVisible);const h=this.Bt(e);h.addEventListener("focus",(t=>this.Vt(i))),h.addEventListener("blur",(t=>this.jt(i)));const o=s.htmlIndex;if(n.gt(o),n._t(s.htmlZIndex),this.Rt){const t=this.G().qt(o);n.bt(t),this.G().Nt(t).appendChild(e)}}Ht(t,s){throw new Error("required override")}$t(t){}Mt(t){const s=t.elementId,i=this.Wt(s);this.$t(i),this.Rt&&i.parentElement.removeChild(i),this.Pt.delete(s)}zt(t,s,i){i||(i={}),i.elementId=s,this._(t,i)}Yt(t,s,i){i||(i={}),i.elementId=s,this.R(t,i)}xt(t){if(!this.Rt)return;const s=this.Pt.get(t.elementId),i=s.kt();s.wt()?i.style.display=t.isVisible?"":"none":s.ut(t.isVisible)}It(t){if(!this.Rt)return;const s=this.Pt.get(t.elementId),i=s.kt(),e=this.G();i.style.left=t.left+"px",i.style.top=t.top+"px",i.style.width=t.width+"px",i.style.height=t.height+"px";const n=t.fontSize;null!==n&&(i.style.fontSize=n+"em");const h=t.htmlIndex;s.gt(h);const o=e.qt(h);o!==s.vt()&&(i.remove(),e.Nt(o).appendChild(i),s.bt(o),e.Xt());const r=t.htmlZIndex;r!==s.St()&&(s._t(r),e.Xt()),s.wt()||(s.ft(),s.dt()&&(i.style.display=""))}Jt(){if(this.Rt)for(const t of this.Pt.values()){const s=this.G().qt(t.yt()),i=t.vt();if(-1!==s&&-1!==i&&s!==i){const i=t.kt();i.remove(),this.G().Nt(s).appendChild(i),t.bt(s)}}}Kt(){return this.Rt?[...this.Pt.values()]:null}Tt(t){const s=this.Wt(t.elementId);this.Zt(s,t)}Zt(t,s){throw new Error("required override")}Bt(t){return t}Vt(t){this.zt("elem-focused",t)}jt(t){this.zt("elem-blurred",t)}At(t){const s=this.Bt(this.Wt(t.elementId));t.focus?s.focus():s.blur()}Gt(t){const s=this.Wt(t.elementId),i=t.prop,e=t.val;i.startsWith("--")?s.style.setProperty(i,e):s.style[i]=e}Et(t){this.Wt(t.elementId).setAttribute(t.name,t.val)}Ft(t){this.Wt(t.elementId).removeAttribute(t.name)}Wt(t){const s=this.Pt.get(t);if(!s)throw new Error(`no element with id ${t}`);return s.kt()}}}{const s=/(iphone|ipod|ipad|macos|macintosh|mac os x)/i.test(navigator.userAgent),i=/android/i.test(navigator.userAgent),e=/safari/i.test(navigator.userAgent)&&!/(chrome|chromium|edg\/|OPR\/|nwjs)/i.test(navigator.userAgent);let n=0;function h(t){const s=document.createElement("script");return s.async=!1,s.type="module",t.Qt?new Promise((i=>{const e="c3_resolve_"+n;++n,self[e]=i,s.textContent=t.ts+`\n\nself["${e}"]();`,document.head.appendChild(s)})):new Promise(((i,e)=>{s.onload=i,s.onerror=e,s.src=t,document.head.appendChild(s)}))}async function o(){if(!navigator.userActivation||"undefined"==typeof OffscreenCanvas)return!1;try{let t=!1;const s=new Blob(['\n\tself.addEventListener("message", () =>\n\t{\n\t\ttry {\n\t\t\tconst offscreenCanvas = new OffscreenCanvas(32, 32);\n\t\t\tconst gl = offscreenCanvas.getContext("webgl");\n\t\t\tself.postMessage(!!gl);\n\t\t}\n\t\tcatch (err)\n\t\t{\n\t\t\tconsole.warn("Feature detection worker error:", err);\n\t\t\tself.postMessage(false);\n\t\t}\n\t});'],{type:"text/javascript"}),i=new Worker(URL.createObjectURL(s),{get type(){t=!0}}),e=await new Promise((t=>{i.addEventListener("message",(s=>{i.terminate(),t(s.data)})),i.postMessage("")}));return t&&e}catch(t){return console.warn("Error feature detecting worker mode: ",t),!1}}let r=new Audio;const a={"audio/webm; codecs=opus":!!r.canPlayType("audio/webm; codecs=opus"),"audio/ogg; codecs=opus":!!r.canPlayType("audio/ogg; codecs=opus"),"audio/webm; codecs=vorbis":!!r.canPlayType("audio/webm; codecs=vorbis"),"audio/ogg; codecs=vorbis":!!r.canPlayType("audio/ogg; codecs=vorbis"),"audio/mp4":!!r.canPlayType("audio/mp4"),"audio/mpeg":!!r.canPlayType("audio/mpeg")};async function c(t){const s=await l(t);return new TextDecoder("utf-8").decode(s)}function l(t){return new Promise(((s,i)=>{const e=new FileReader;e.onload=t=>s(t.target.result),e.onerror=t=>i(t),e.readAsArrayBuffer(t)}))}r=null;const u=[];let d=0;const w=8;window.RealFile=window.File;const f=[],m=new Map,p=new Map;let y=0;const g=[];self.runOnStartup=function(t){if("function"!=typeof t)throw new Error("runOnStartup called without a function");g.push(t)};const v=new Set(["cordova","playable-ad-single-file","playable-ad-zip","instant-games"]);function b(t){return v.has(t)}let _=!1;window.ss=class t{constructor(t){if(this.es=t.ns,this.hs=null,this.rs="",this.cs=t.ls,this.us=null,this.ds=null,this.ws=[],this.fs=null,this.ps=!0,this.ys=[],this.gs=[],this.vs=!1,this.bs=()=>this._s(),this.Ss=!1,this.ks=0,this.Os=null,this.Ps=-1,this.Rs=()=>this.Cs(),this.Ms=new Set,this.xs=null,this.Is=[],this.Ts=t.As,this.Gs="file"===location.protocol.substr(0,4),this.Es=[],"playable-ad-single-file"!==this.Ts&&"playable-ad-zip"!==this.Ts&&"instant-games"!==this.Ts||(this.es=!1),e&&(this.es=!1),"cordova"===this.Ts&&this.es&&i){const t=/Chrome\/(\d+)/i.exec(navigator.userAgent);t&&parseInt(t[1],10)>=90||(this.es=!1)}this.Fs()?self.chrome.webview.addEventListener("message",(t=>this.Ls(t.data,t.additionalObjects))):"macos-wkwebview"===this.Ts?self.C3WrapperOnMessage=t=>this.Ls(JSON.parse(t)):"linux-cef"===this.Ts&&self.c3_linux_cef_set_message_callback((t=>this.Ls(JSON.parse(t)))),this.Ds=null,this.Ws=null,"html5"!==this.Ts||window.isSecureContext||console.warn("[Construct] Warning: the browser indicates this is not a secure context. Some features may be unavailable. Use secure (HTTPS) hosting to ensure all features are available."),this.T("canvas","update-size",(t=>this.Us(t))),this.T("canvas","set-html-layer-count",(t=>this._OnSetHTMLLayerCount(t))),this.T("canvas","cleanup-html-layers",(()=>this.Hs())),this.T("canvas","update-html-layer-dom-state",(t=>this.Bs(t.layersDomState))),this.T("runtime","cordova-fetch-local-file",(t=>this.Vs(t))),this.T("runtime","create-job-worker",(t=>this.js(t))),this.T("runtime","send-wrapper-extension-message",(t=>this.qs(t))),"cordova"===this.Ts?document.addEventListener("deviceready",(()=>this.Ns(t))):this.Ns(t),this.$s=0}et(){this.zs(),this.hs&&(this.hs.onmessage=null,this.hs=null),this.us&&(this.us.terminate(),this.us=null),this.ds&&(this.ds.et(),this.ds=null);for(const{canvas:t,Ys:s}of this.ys)t.remove(),s.remove();this.ys.length=0}Xs(){return this.ys[0].canvas}qt(t){return Math.min(t,this.ys.length-1)}Nt(t){if(t<0||t>=this.ys.length)throw new RangeError("invalid canvas layer");return this.ys[t].Ys}_GetHTMLWrapElement(t){return this.Nt(t)}Js(){return this.rs}C(){return this.es}Ks(){return this.Ts}Zs(){return this.Gs}Qs(){return this.cs}ti(){return s&&"cordova"===this.Ts}si(){const t=navigator.userAgent;return s&&b(this.Ts)||navigator.standalone||/crios\/|fxios\/|edgios\//i.test(t)}ii(){return i}ei(){return i&&b(this.Ts)}ni(){return"windows-webview2"===this.Ts||!!("preview"===this.Ts&&window.chrome&&window.chrome.webview&&window.chrome.webview.postMessage)}Fs(){return this.ni()||"xbox-uwp-webview2"===this.Ts}hi(){this.ei()&&this.$s++}oi(){return this.ri().next().value}*ri(){if(!this.ei())return!0;yield 0===this.$s,this.$s>0&&this.$s--}async Ns(t){if(this.es&&(await o()||(this.es=!1)),"macos-wkwebview"===this.Ts&&this.ai({type:"ready"}),this.Fs()||"macos-wkwebview"===this.Ts||"linux-cef"===this.Ts){this.ci();const t=await this.li();this.Is=t.registeredComponentIds}if("playable-ad-single-file"===this.Ts&&(this.Ds=self.c3_base64files,this.Ws={},await this.di()),"nwjs"===this.Ts&&self.nw&&(self.nw.Window.get().on("close",(()=>self.nw.App.quit())),self.nw.App.manifest["c3-steam-mode"])){let t=0;this.D((()=>{t++,document.documentElement.style.opacity=t%2==0?"1":"0.999"}))}if(t.wi)this.rs=t.wi;else{const t=location.origin;this.rs=("null"===t?"file:///":t)+location.pathname;const s=this.rs.lastIndexOf("/");-1!==s&&(this.rs=this.rs.substr(0,s+1))}const s=new MessageChannel;if(this.hs=s.port1,this.hs.onmessage=t=>this._OnMessageFromRuntime(t.data),window.c3_addPortMessageHandler&&window.c3_addPortMessageHandler((t=>this.fi(t))),this.Os=new self.mi(this),await this.Os.pi(),"object"==typeof window.StatusBar&&window.StatusBar.hide(),"object"==typeof window.AndroidFullScreen)try{await new Promise(((t,s)=>{window.AndroidFullScreen.immersiveMode(t,s)}))}catch(t){console.error("Failed to enter Android immersive mode: ",t)}this.es?await this.yi(t,s.port2):await this.gi(t,s.port2)}bi(s){return{runtimeBaseUrl:this.rs,previewUrl:location.href,windowInnerWidth:this._i(),windowInnerHeight:this.Si(),cssDisplayMode:this.ki(),devicePixelRatio:window.devicePixelRatio,isFullscreen:t.Oi(),swClientId:window.cr_swClientId||"",exportType:s.As,isNWjs:"undefined"!=typeof nw,fileMap:globalThis.Pi??new Map(Object.entries(this.Ds??{})),scriptFolder:this.cs,isDebug:new URLSearchParams(self.location.search).has("debug"),ife:!!self.Ri,jobScheduler:this.Os.Ci(),supportedAudioFormats:a,isFileProtocol:this.Gs,isiOSCordova:this.ti(),isiOSWebView:this.si(),isWindowsWebView2:this.ni(),isAnyWebView2Wrapper:this.Fs(),wrapperComponentIds:this.Is,isFBInstantAvailable:void 0!==self.FBInstant}}async yi(t,s){const i=t.Mi;"preview"===this.Ts?(this.us=new Worker("previewworker.js",{type:"module",name:"Runtime"}),await new Promise(((t,s)=>{const e=i=>{this.us.removeEventListener("message",e),i.data&&"ok"===i.data.type?t():s()};this.us.addEventListener("message",e),this.us.postMessage({type:"construct-worker-init",import:new URL(i,this.rs).toString()})}))):this.us=await this.xi(i,{type:"module",name:"Runtime"});const e=document.createElement("canvas");e.style.display="none";const n=e.transferControlToOffscreen();document.body.appendChild(e);const h=document.createElement("div");h.className="c3htmlwrap",h.setAttribute("interactive",""),document.body.appendChild(h),this.ys.push({canvas:e,Ys:h,Ii:{isVisible:!0,opacity:1,Ti:!0}}),window.c3canvas=e,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.us.postMessage(Object.assign(this.bi(t),{type:"init-runtime",isInWorker:!0,messagePort:s,canvas:n,runtimeScriptList:t.Ai,projectMainScriptPath:t.Gi,scriptsInEventsPath:t.Ei}),[s,n,...this.Os.Fi()]),this.ws=f.map((t=>new t(this))),this.Li(),this.fs.Di(e),this.fs.Wi(h),this.fs.Ui(),self.c3_callFunction=(t,s)=>this.fs.Hi(t,s),"preview"===this.Ts&&(self.goToLastErrorScript=()=>this.S("runtime","go-to-last-error-script"))}async gi(t,s){const i=document.createElement("canvas");i.style.display="none",document.body.appendChild(i);const e=document.createElement("div");e.className="c3htmlwrap",e.setAttribute("interactive",""),document.body.appendChild(e),this.ys.push({canvas:i,Ys:e,Ii:{isVisible:!0,opacity:1,Ti:!0}}),window.c3canvas=i,self.C3_InsertHTMLPlaceholders&&self.C3_InsertHTMLPlaceholders(),this.ws=f.map((t=>new t(this))),this.Li(),this.fs.Di(i),this.fs.Wi(e);const n=await Promise.all(t.Ai.map((t=>this.Bi(t))));await Promise.all(n.map((t=>h(t))));const o=t.Gi,r=t.Ei;if(o)try{if(await h(o),"preview"===this.Ts&&!globalThis.Vi)throw new Error("main script did not run to completion")}catch(t){this.ji(),console.error("Error loading project main script: ",t),alert(`Failed to load the project main script (${o}). Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the script. Press F12 and check the console for error details.`)}if(r)try{if(await h(r),"preview"===this.Ts&&!globalThis.$i.Ni)throw new Error("scripts in events did not run to completion")}catch(t){this.ji(),console.error("Error loading scripts in events: ",t),alert("Failed to load scripts in events. Check all your JavaScript code has valid syntax, all imports are written correctly, and that an exception was not thrown running the 'Imports for events' script. Press F12 and check the console for error details.")}const a=Object.assign(this.bi(t),{isInWorker:!1,messagePort:s,canvas:i,runOnStartupFunctions:g});this.fs.Ui(),this.zi(),this.ds=self.C3_CreateRuntime(a),await self.C3_InitRuntime(this.ds,a)}async xi(t,s){if(t.startsWith("blob:"))return new Worker(t,s);if("cordova"===this.Ts&&this.Gs){const i=await this.Yi(t),e=new Blob([i],{type:"application/javascript"});return new Worker(URL.createObjectURL(e),s)}if("playable-ad-single-file"===this.Ts){const i=this.Ds[t];if(!i)throw new Error("missing script: "+t);return new Worker(URL.createObjectURL(i),s)}const i=new URL(t,location.href);if(location.origin!==i.origin){const t=await fetch(i);if(!t.ok)throw new Error("failed to fetch worker script");const e=await t.blob();return new Worker(URL.createObjectURL(e),s)}return new Worker(i,s)}_i(){return Math.max(window.innerWidth,1)}Si(){return Math.max(window.innerHeight,1)}ki(){if(this.Fs())return"standalone";const t=this.Ks();return new Set(["cordova","nwjs","macos-wkwebview","linux-cef"]).has(t)?"standalone":window.matchMedia("(display-mode: fullscreen)").matches?"fullscreen":window.matchMedia("(display-mode: standalone)").matches?"standalone":window.matchMedia("(display-mode: minimal-ui)").matches?"minimal-ui":navigator.standalone?"standalone":"browser"}zi(){this.ji()}ji(){const t=window.cr_previewLoadingElem;t&&(t.parentElement.removeChild(t),window.cr_previewLoadingElem=null)}async js(t){const s=await this.Os.Xi();return{outputPort:s,transferables:[s]}}Us(t){if(this.Ji())return;const s=t.styleWidth+"px",i=t.styleHeight+"px",e=t.marginLeft+"px",n=t.marginTop+"px";for(const{canvas:t,Ys:h}of this.ys)t.style.width=s,t.style.height=i,t.style.marginLeft=e,t.style.marginTop=n,h.style.width=s,h.style.height=i,h.style.marginLeft=e,h.style.marginTop=n,this.ps&&(t.style.display="",h.style.display="");document.documentElement.style.setProperty("--construct-scale",t.displayScale),this.ps=!1}_OnSetHTMLLayerCount(t){const s=t.count,i=t.layersDomState,e=t.immediate,n=t.styleWidth+"px",h=t.styleHeight+"px",o=t.marginLeft+"px",r=t.marginTop+"px",a=[],c=[];if(s<this.ys.length)for(;this.ys.length>s;){const{canvas:t,Ys:s}=this.ys.pop();s.remove(),this.es&&!e?this.gs.push(t):t.remove()}else if(s>this.ys.length)for(let t=0,i=s-this.ys.length;t<i;++t){const t=document.createElement("canvas");if(t.classList.add("c3overlay"),this.es){const s=t.transferControlToOffscreen();a.push(s),c.push(s)}else a.push(t);document.body.appendChild(t);const s=document.createElement("div");s.classList.add("c3htmlwrap","c3overlay"),s.setAttribute("interactive",""),document.body.appendChild(s),t.style.width=n,t.style.height=h,t.style.marginLeft=o,t.style.marginTop=r,s.style.width=n,s.style.height=h,s.style.marginLeft=o,s.style.marginTop=r,this.fs.Di(t),this.fs.Wi(s),this.ys.push({canvas:t,Ys:s,Ii:{isVisible:!0,opacity:1,Ti:!0}})}this.Bs(i);for(const t of this.ws)t instanceof window.Ot&&t.Jt();return this.Xt(),{addedCanvases:a,transferables:c}}Bs(t){for(let s=0,i=Math.min(this.ys.length,t.length);s<i;++s){const{Ys:i,Ii:e}=this.ys[s],n=t[s],h=n.isVisible,o=n.opacity,r=n.isInteractive;h!==e.isVisible&&(i.style.display=h?"":"none",e.isVisible=h),o!==e.opacity&&(i.style.opacity=1===o?"":String(o),e.opacity=o),r!==e.Ti&&(i.style.pointerEvents=r?"":"none",r?i.setAttribute("interactive",""):i.removeAttribute("interactive"),e.Ti=r)}}Hs(){for(const t of this.gs)t.remove();this.gs.length=0}Xt(){this.vs||(this.vs=!0,this.D(this.bs))}_s(){this.U(this.bs),this.vs=!1;let t=[];for(const s of this.ws)if(s instanceof window.Ot){const i=s.Kt();i&&t.push(...i)}t.sort(((t,s)=>{const i=t.vt(),e=s.vt();return i!==e?i-e:t.St()-s.St()}));let s=0,i=0,e=0,n=t.length;for(;e<n;++e){const n=t[e];n.vt()!==s&&(this.Ki(s,t.slice(i,e)),s=n.vt(),i=e)}i<e&&this.Ki(s,t.slice(i,e))}Ki(t,s){if(s.length<=1)return;if(t>=this.ys.length)return;const i=s.map((t=>t.kt())),e=new Set(i),n=this.Nt(t),h=Array.from(n.children).filter((t=>e.has(t)));for(let t=0,s=0,e=i.length;t<e;++t){const e=i[t],o=h[s];e===o?++s:n.moveBefore?n.moveBefore(e,o):n.insertBefore(e,o)}}M(){if(this.es)throw new Error("not available in worker mode");return this.ds}S(t,s,i,e,n){this.hs.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:null},n)}P(t,s,i,e,n){const h=y++,o=new Promise(((t,s)=>{p.set(h,{resolve:t,reject:s})}));return this.hs.postMessage({type:"event",component:t,handler:s,dispatchOpts:e||null,data:i,responseId:h},n),o}_OnMessageFromRuntime(t){const s=t.type;if("event"===s)return this.Zi(t);if("result"===s)this.Qi(t);else if("runtime-ready"===s)this.te();else if("alert-error"===s)this.ji(),alert(t.message);else{if("creating-runtime"!==s)throw new Error(`unknown message '${s}'`);this.zi()}}Zi(t){const s=t.component,i=t.handler,e=t.data,n=t.responseId,h=m.get(s);if(!h)return void console.warn(`[DOM] No event handlers for component '${s}'`);const o=h.get(i);if(!o)return void console.warn(`[DOM] No handler '${i}' for component '${s}'`);let r=null;try{r=o(e)}catch(t){return console.error(`Exception in '${s}' handler '${i}':`,t),void(null!==n&&this.se(n,!1,""+t))}if(null===n)return r;r&&r.then?r.then((t=>this.se(n,!0,t))).catch((t=>{console.error(`Rejection from '${s}' handler '${i}':`,t),this.se(n,!1,""+t)})):this.se(n,!0,r)}se(t,s,i){let e;i&&i.transferables&&(e=i.transferables),this.hs.postMessage({type:"result",responseId:t,isOk:s,result:i},e)}Qi(t){const s=t.responseId,i=t.isOk,e=t.result,n=p.get(s);i?n.resolve(e):n.reject(e),p.delete(s)}T(t,s,i){let e=m.get(t);if(e||(e=new Map,m.set(t,e)),e.has(s))throw new Error(`[DOM] Component '${t}' already has handler '${s}'`);e.set(s,i)}static ie(t){if(f.includes(t))throw new Error("DOM handler already added");f.push(t)}Li(){for(const t of this.ws)if("runtime"===t.F())return void(this.fs=t);throw new Error("cannot find runtime DOM handler")}fi(t){this.S("debugger","message",t)}te(){for(const t of this.ws)t.v()}static Oi(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||_)}static ee(t){_=!!t}async ne(){return await this.P("runtime","get-remote-preview-status-info")}D(t){this.Ms.add(t),this.he()}U(t){this.Ms.delete(t),0===this.Ms.size&&this.zs()}he(){-1===this.Ps&&this.Ms.size>0&&(this.Ps=requestAnimationFrame(this.Rs))}zs(){-1!==this.Ps&&(cancelAnimationFrame(this.Ps),this.Ps=-1)}Cs(){this.Ps=-1;for(const t of this.Ms)t();this.he()}oe(t){this.fs.oe(t)}re(t){this.fs.re(t)}ae(){this.fs.ae()}ce(t){this.fs.ce(t)}le(t){return!!a[t]}ue(t){this.Ss=!0,this.ks=t}Ji(){return this.Ss}de(){return this.ks}we(t){return/^(?:[a-z\-]+:)?\/\//.test(t)||"data:"===t.substr(0,5)||"blob:"===t.substr(0,5)}fe(t){return!this.we(t)}async Bi(t){if("cordova"===this.Ts&&(t.startsWith("file:")||this.Gs&&this.fe(t))){let s=t;s.startsWith(this.rs)&&(s=s.substr(this.rs.length));const i=await this.Yi(s),e=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(e)}if("playable-ad-single-file"===this.Ts){if(this.Ws.hasOwnProperty(t))return{Qt:!0,ts:this.Ws[t]};if(this.Ds.hasOwnProperty(t))return URL.createObjectURL(this.Ds[t]);throw new Error("missing script: "+t)}return t}async Vs(t){const s=t.filename;switch(t.as){case"text":return await this.me(s);case"buffer":return await this.Yi(s);default:throw new Error("unsupported type")}}pe(t){const s=window.cordova.file.applicationDirectory+"www/"+t;return new Promise(((t,i)=>{window.resolveLocalFileSystemURL(s,(s=>{s.file(t,i)}),i)}))}async me(t){const s=await this.pe(t);return await c(s)}ye(){if(!u.length)return;if(d>=w)return;d++;const t=u.shift();this.ge(t.filename,t.ve,t.be)}Yi(t){return new Promise(((s,i)=>{u.push({filename:t,ve:t=>{d--,this.ye(),s(t)},be:t=>{d--,this.ye(),i(t)}}),this.ye()}))}async ge(t,s,i){try{const i=await this.pe(t);s(await l(i))}catch(t){i(t)}}_PlayableAdFetchBlob(t){if(this.Ds.hasOwnProperty(t))return this.Ds[t];throw new Error("missing file: "+t)}_e(){const t=window.cordova&&window.cordova.plugins&&window.cordova.plugins.permissions;if("object"!=typeof t)throw new Error("Permission API is not loaded");return t}Se(t,s){const i=t[s];if("string"!=typeof i)throw new Error("Invalid permission name");return i}ke(t){const s=this._e();return new Promise(((i,e)=>s.checkPermission(this.Se(s,t),(t=>i(!!t.hasPermission)),e)))}Oe(t){const s=this._e();return new Promise(((i,e)=>s.requestPermission(this.Se(s,t),(t=>i(!!t.hasPermission)),e)))}async Pe(t){if("cordova"!==this.Ks())return!0;if(this.ti())return!0;for(const s of t)if(!await this.ke(s)&&!1===await this.Oe(s))return!1;return!0}async Re(...t){if(!1===await this.Pe(t))throw new Error("Permission not granted")}Ls(s,i){if("object"!=typeof s||!s)return void console.warn("Unknown wrapper message: ",s);const e=s.type;if("directory-handles"===e)this.Es=i;else if("wrapper-init-response"===e)this.xs(s),this.xs=null;else if("fullscreen-change"===e)t.ee(s.isFullscreen),this.fs.Ce();else if("log-to-console"===e)switch(s.logType){case"error":console.error(s.message);break;case"warning":console.warn(s.message);break;default:console.log(s.message)}else"extension-message"===e?this.S("runtime","wrapper-extension-message",s):console.warn("Unknown wrapper message: ",s)}qs(t){this.ai({type:"extension-message",componentId:t.componentId,messageId:t.messageId,params:t.params||[],asyncId:t.asyncId})}ai(t){this.Fs()?window.chrome.webview.postMessage(JSON.stringify(t)):"macos-wkwebview"===this.Ts?window.webkit.messageHandlers.C3Wrapper.postMessage(JSON.stringify(t)):"linux-cef"===this.Ts&&window.c3_linux_cef_sendmessage(JSON.stringify(t))}ci(){window.moveTo=(t,s)=>{this.ai({type:"set-window-position",windowX:Math.ceil(t),windowY:Math.ceil(s)})},window.resizeTo=(t,s)=>{this.ai({type:"set-window-size",windowWidth:Math.ceil(t),windowHeight:Math.ceil(s)})}}li(){return new Promise((t=>{this.xs=t,this.ai({type:"wrapper-init"})}))}Me(){return this.Es}async di(){const t=[];for(const[s,i]of Object.entries(this.Ds))t.push(this.xe(s,i));await Promise.all(t)}async xe(t,s){if("object"==typeof s)this.Ds[t]=new Blob([s.str],{type:s.type}),this.Ws[t]=s.str;else{let i=await this.Ie(s);i||(i=this.Te(s)),this.Ds[t]=i}}async Ie(t){try{const s=await fetch(t);return await s.blob()}catch(t){return console.warn("Failed to fetch a data: URI. Falling back to a slower workaround. This is probably because the Content Security Policy unnecessarily blocked it. Allow data: URIs in your CSP to avoid this.",t),null}}Te(t){const s=this.Ae(t);return this.Ge(s.data,s.Ee)}Ae(t){const s=t.indexOf(",");if(s<0)throw new URIError("expected comma in data: uri");const i=t.substring(5,s),e=t.substring(s+1),n=i.split(";"),h=n[0]||"",o=n[1],r=n[2];let a;return a="base64"===o||"base64"===r?atob(e):decodeURIComponent(e),{Ee:h,data:a}}Ge(t,s){let i,e,n=t.length,h=n>>2,o=new Uint8Array(n),r=new Uint32Array(o.buffer,0,h);for(i=0,e=0;i<h;++i)r[i]=t.charCodeAt(e++)|t.charCodeAt(e++)<<8|t.charCodeAt(e++)<<16|t.charCodeAt(e++)<<24;let a=3&n;for(;a--;)o[e]=t.charCodeAt(e),++e;return new Blob([o],{type:s})}}}{const S=self.ss;function k(t){return t.sourceCapabilities&&t.sourceCapabilities.firesTouchEvents||t.originalEvent&&t.originalEvent.sourceCapabilities&&t.originalEvent.sourceCapabilities.firesTouchEvents}const O=new Map([["OSLeft","MetaLeft"],["OSRight","MetaRight"]]),P={dispatchRuntimeEvent:!0,dispatchUserScriptEvent:!0},R={dispatchUserScriptEvent:!0},C={dispatchRuntimeEvent:!0};async function M(t){const s=URL.createObjectURL(t);try{return await(i=s,new Promise(((t,s)=>{const e=new Image;e.onload=()=>t(e),e.onerror=t=>s(t),e.src=i})))}finally{URL.revokeObjectURL(s)}var i}function x(t){do{if(t.parentNode&&t.hasAttribute("contenteditable"))return!0;t=t.parentNode}while(t);return!1}const I=new Set(["input","textarea","datalist","select"]),T=new Set(["canvas","body","html"]);function A(t){if(!t.target.tagName)return;const s=t.target.tagName.toLowerCase();T.has(s)&&t.preventDefault()}function G(t){t.target.tagName&&t.target.classList.contains("c3htmlwrap")&&t.preventDefault()}function E(t){(t.metaKey||t.ctrlKey)&&t.preventDefault()}self.C3_GetSvgImageSize=async function(t){const s=await M(t);if(s.width>0&&s.height>0)return[s.width,s.height];{s.style.position="absolute",s.style.left="0px",s.style.top="0px",s.style.visibility="hidden",document.body.appendChild(s);const t=s.getBoundingClientRect();return document.body.removeChild(s),[t.width,t.height]}},self.C3_RasterSvgImageBlob=async function(t,s,i,e,n){const h=await M(t),o=document.createElement("canvas");return o.width=e,o.height=n,o.getContext("2d").drawImage(h,0,0,s,i),o};let F=!1;function L(){try{return window.parent&&window.parent.document.hasFocus()}catch(t){return!1}}document.addEventListener("pause",(()=>F=!0)),document.addEventListener("resume",(()=>F=!1));const D="runtime",W=class extends self.i{constructor(t){super(t,D),this.Fe=!1,this.Le=-1,this.De="any",this.We=!1,this.Ue=!1,this.He=!1,this.Be=document.createElement("div"),this.Be.className="c3-screen-reader-text",this.Be.setAttribute("aria-live","polite"),document.body.appendChild(this.Be),this.Ve=null,this.je=!1,this.qe="",this.Ne=-1,this.$e=!1,this.ze=t._i(),this.Ye=t.Si(),this.Xe=0,this.Je=0,t.T("runtime","invoke-download",(t=>this.Ke(t))),t.T("runtime","load-webfonts",(t=>this.Ze(t))),t.T("runtime","raster-svg-image",(t=>this.Qe(t))),t.T("runtime","get-svg-image-size",(t=>this.tn(t))),t.T("runtime","set-target-orientation",(t=>this.sn(t))),t.T("runtime","register-sw",(()=>this.en())),t.T("runtime","post-to-debugger",(t=>this.nn(t))),t.T("runtime","go-to-script",(t=>this.nn(t))),t.T("runtime","before-start-ticking",(()=>this.hn())),t.T("runtime","debug-highlight",(t=>this.rn(t))),t.T("runtime","enable-device-orientation",(()=>this.an())),t.T("runtime","enable-device-motion",(()=>this.cn())),t.T("runtime","add-stylesheet",(t=>this.ln(t))),t.T("runtime","script-create-worker",(t=>this.un(t))),t.T("runtime","alert",(t=>this.dn(t))),t.T("runtime","screen-reader-text",(t=>this.wn(t))),t.T("runtime","hide-cordova-splash",(()=>this.fn())),t.T("runtime","set-exporting-to-video",(t=>this.mn(t))),t.T("runtime","export-to-video-progress",(t=>this.pn(t))),t.T("runtime","exported-to-video",(t=>this.yn(t))),t.T("runtime","exported-to-image-sequence",(t=>this.gn(t)));const s=new Set(["input","textarea","datalist"]);if(window.addEventListener("contextmenu",(t=>{const i=t.target,e=i.tagName.toLowerCase();s.has(e)||x(i)||t.preventDefault()})),window.addEventListener("selectstart",A),window.addEventListener("gesturehold",A),window.addEventListener("touchstart",A,{passive:!1}),window.addEventListener("pointerdown",A,{passive:!1}),this.vn=0,window.addEventListener("mousedown",(t=>{1===t.button&&t.preventDefault()})),window.addEventListener("mousewheel",E,{passive:!1}),window.addEventListener("wheel",E,{passive:!1}),window.addEventListener("resize",(()=>this.bn())),window.addEventListener("fullscreenchange",(()=>this.Ce())),window.addEventListener("webkitfullscreenchange",(()=>this.Ce())),window.addEventListener("mozfullscreenchange",(()=>this.Ce())),window.addEventListener("fullscreenerror",(t=>this._n(t))),window.addEventListener("webkitfullscreenerror",(t=>this._n(t))),window.addEventListener("mozfullscreenerror",(t=>this._n(t))),t.si()){let t=1/0;window.visualViewport.addEventListener("resize",(()=>{const s=window.visualViewport.height;s>t&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0),t=s})),document.documentElement.setAttribute("ioswebview","")}this.Sn=new Set,this.kn=new WeakSet,this.On=!1}Di(t){t.addEventListener("selectstart",A),t.addEventListener("gesturehold",A),t.addEventListener("pointerdown",A)}Wi(t){t.addEventListener("selectstart",G),t.addEventListener("gesturehold",G),t.addEventListener("touchstart",G)}hn(){return self.setTimeout((()=>{this.$e=!0}),1e3),"cordova"===this.h.Ks()?(document.addEventListener("pause",(()=>this.Pn(!0))),document.addEventListener("resume",(()=>this.Pn(!1)))):document.addEventListener("visibilitychange",(()=>this.Pn("hidden"===document.visibilityState))),this.He=!("hidden"!==document.visibilityState&&!F),{isSuspended:this.He}}v(){window.addEventListener("focus",(()=>this.Rn("window-focus"))),window.addEventListener("blur",(()=>{this.Rn("window-blur",{parentHasFocus:L()}),this.vn=0})),window.addEventListener("focusin",(t=>{var s;s=t.target,(I.has(s.tagName.toLowerCase())||x(s))&&this.Rn("keyboard-blur")})),window.addEventListener("keydown",(t=>this.Cn("keydown",t))),window.addEventListener("keyup",(t=>this.Cn("keyup",t))),window.addEventListener("mousedown",(t=>this.Mn("mousedown",t,R))),window.addEventListener("mousemove",(t=>this.Mn("mousemove",t,R))),window.addEventListener("mouseup",(t=>this.Mn("mouseup",t,R))),window.addEventListener("dblclick",(t=>this.Mn("dblclick",t,P))),window.addEventListener("wheel",(t=>this.xn("wheel",t,P))),window.addEventListener("pointerdown",(t=>{this.In(t),this.Tn("pointerdown",t)})),this.h.C()&&void 0!==window.onpointerrawupdate&&self===self.top?window.addEventListener("pointerrawupdate",(t=>this.An(t))):window.addEventListener("pointermove",(t=>this.Tn("pointermove",t))),window.addEventListener("pointerup",(t=>this.Tn("pointerup",t))),window.addEventListener("pointercancel",(t=>this.Tn("pointercancel",t)));const t=()=>this.ae();window.addEventListener("pointerup",t,!0),window.addEventListener("touchend",t,!0),window.addEventListener("click",t,!0),window.addEventListener("keydown",t,!0),window.addEventListener("gamepadconnected",t,!0),this.h.ii()&&!this.h.ei()&&navigator.virtualKeyboard&&(navigator.virtualKeyboard.overlaysContent=!0,navigator.virtualKeyboard.addEventListener("geometrychange",(()=>{this.Gn(this.Si(),navigator.virtualKeyboard.boundingRect.height)}))),this.h.si()&&(document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0)}Gn(t,s){if(document.body.style.position="",document.body.style.overflow="",document.body.style.transform="",this.Je=0,s>0){const i=document.activeElement;if(i){const e=i.getBoundingClientRect();let n=(e.top+e.bottom)/2-(t-s)/2;n>s&&(n=s),n<0&&(n=0),n>0&&(document.body.style.position="absolute",document.body.style.overflow="visible",document.body.style.transform=`translateY(${-n}px)`,this.Je=n)}}}Rn(t,s){this._(t,s||null,C)}_i(){return this.h._i()}Si(){return this.h.Si()}Ui(){this.Fe=!0,this.ze=this.h._i(),this.Ye=this.h.Si()}bn(){if(this.je)return;if(!this.Fe)return;const t=this._i(),s=this.Si();if(this.h.ei())if(this.$e){if(this.h.oi()&&this.ze===t&&s<this.Ye)return this.Xe=this.Ye-s,void this.Gn(this.Ye,this.Xe);this.Xe>0&&(this.Xe=0,this.Gn(s,this.Xe)),this.ze=t,this.Ye=s}else this.ze=t,this.Ye=s;this._("window-resize",{innerWidth:t,innerHeight:s,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Oi(),cssDisplayMode:this.h.ki()}),this.h.si()&&(-1!==this.Le&&clearTimeout(this.Le),this.En(t,s,0))}Fn(t,s,i){-1!==this.Le&&clearTimeout(this.Le),this.Le=setTimeout((()=>this.En(t,s,i)),48)}En(t,s,i){const e=this._i(),n=this.Si();this.Le=-1,e!=t||n!=s?this._("window-resize",{innerWidth:e,innerHeight:n,devicePixelRatio:window.devicePixelRatio,isFullscreen:S.Oi(),cssDisplayMode:this.h.ki()}):i<10&&this.Fn(e,n,i+1)}sn(t){this.De=t.targetOrientation}Ln(){const t=this.De;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(t).catch((t=>console.warn("[Construct] Failed to lock orientation: ",t)));else try{let s=!1;screen.lockOrientation?s=screen.lockOrientation(t):screen.webkitLockOrientation?s=screen.webkitLockOrientation(t):screen.mozLockOrientation?s=screen.mozLockOrientation(t):screen.msLockOrientation&&(s=screen.msLockOrientation(t)),s||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}Ce(){if(this.je)return;const t=S.Oi();t&&"any"!==this.De&&this.Ln(),this._("fullscreenchange",{isFullscreen:t,innerWidth:this._i(),innerHeight:this.Si()})}_n(t){console.warn("[Construct] Fullscreen request failed: ",t),this._("fullscreenerror",{isFullscreen:S.Oi(),innerWidth:this._i(),innerHeight:this.Si()})}Pn(t){if(this.He!==t&&(this.He=t,t?this.h.zs():this.h.he(),this._("visibilitychange",{hidden:t}),!t&&this.h.si())){const t=()=>{document.scrollingElement.scrollTop=0,document.scrollingElement.scrollLeft=0};setTimeout(t,50),setTimeout(t,100),setTimeout(t,250),setTimeout(t,500)}}Cn(t,s){if(void 0===s.key)return;if("Backspace"===s.key&&A(s),"nwjs"===this.h.Ks()&&"u"===s.key&&(s.ctrlKey||s.metaKey)&&s.preventDefault(),this.je)return;const i=O.get(s.code)||s.code;this.R(t,{code:i,key:s.key,which:s.which,repeat:s.repeat,altKey:s.altKey,ctrlKey:s.ctrlKey,metaKey:s.metaKey,shiftKey:s.shiftKey,timeStamp:s.timeStamp},P)}xn(t,s,i){this.je||this._(t,{clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,deltaX:s.deltaX,deltaY:s.deltaY,deltaZ:s.deltaZ,deltaMode:s.deltaMode,timeStamp:s.timeStamp},i)}Mn(t,s,i){this.je||k(s)||this.R(t,{button:s.button,buttons:s.buttons,clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,timeStamp:s.timeStamp},i)}Tn(t,s){if(this.je)return;let i=0;"mouse"===s.pointerType&&(i=this.vn),this.R(t,{pointerId:s.pointerId,pointerType:s.pointerType,button:s.button,buttons:s.buttons,lastButtons:i,clientX:s.clientX,clientY:s.clientY+this.Je,pageX:s.pageX,pageY:s.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,width:s.width||0,height:s.height||0,pressure:s.pressure||0,tangentialPressure:s.tangentialPressure||0,tiltX:s.tiltX||0,tiltY:s.tiltY||0,twist:s.twist||0,timeStamp:s.timeStamp},P),"mouse"===s.pointerType&&(this.vn=s.buttons)}An(t){this.Tn("pointermove",t)}Dn(t,s){if(!this.je)for(let i=0,e=s.changedTouches.length;i<e;++i){const e=s.changedTouches[i];this.R(t,{pointerId:e.identifier,pointerType:"touch",button:0,buttons:0,lastButtons:0,clientX:e.clientX,clientY:e.clientY+this.Je,pageX:e.pageX,pageY:e.pageY+this.Je,movementX:s.movementX||0,movementY:s.movementY||0,width:2*(e.radiusX||e.webkitRadiusX||0),height:2*(e.radiusY||e.webkitRadiusY||0),pressure:e.force||e.webkitForce||0,tangentialPressure:0,tiltX:0,tiltY:0,twist:e.rotationAngle||0,timeStamp:s.timeStamp},P)}}In(t){window!==window.top&&window.focus(),this.Wn(t.target)&&document.activeElement&&!this.Wn(document.activeElement)&&document.activeElement.blur()}Wn(t){return!t||t===document||t===window||t===document.body||"canvas"===t.tagName.toLowerCase()}an(){this.We||(this.We=!0,window.addEventListener("deviceorientation",(t=>this.Un(t))),window.addEventListener("deviceorientationabsolute",(t=>this.Hn(t))))}cn(){this.Ue||(this.Ue=!0,window.addEventListener("devicemotion",(t=>this.Bn(t))))}Un(t){this.je||this._("deviceorientation",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp,webkitCompassHeading:t.webkitCompassHeading,webkitCompassAccuracy:t.webkitCompassAccuracy},P)}Hn(t){this.je||this._("deviceorientationabsolute",{absolute:!!t.absolute,alpha:t.alpha||0,beta:t.beta||0,gamma:t.gamma||0,timeStamp:t.timeStamp},P)}Bn(t){if(this.je)return;let s=null;const i=t.acceleration;i&&(s={x:i.x||0,y:i.y||0,z:i.z||0});let e=null;const n=t.accelerationIncludingGravity;n&&(e={x:n.x||0,y:n.y||0,z:n.z||0});let h=null;const o=t.rotationRate;o&&(h={alpha:o.alpha||0,beta:o.beta||0,gamma:o.gamma||0}),this._("devicemotion",{acceleration:s,accelerationIncludingGravity:e,rotationRate:h,interval:t.interval,timeStamp:t.timeStamp},P)}Ke(t){const s=t.url,i=t.filename,e=document.createElement("a"),n=document.body;e.textContent=i,e.href=s,e.download=i,n.appendChild(e),e.click(),n.removeChild(e)}async Ze(t){const s=t.webfonts;await Promise.all(s.map((async t=>{const s=new FontFace(t.name,`url('${t.url}')`);document.fonts.add(s),await s.load()})))}async Qe(t){const s=t.blob,i=t.imageWidth,e=t.imageHeight,n=t.surfaceWidth,h=t.surfaceHeight,o=t.imageBitmapOpts,r=await self.C3_RasterSvgImageBlob(s,i,e,n,h);let a;return a=o?await createImageBitmap(r,o):await createImageBitmap(r),{imageBitmap:a,transferables:[a]}}async tn(t){return await self.C3_GetSvgImageSize(t.blob)}async ln(t){var s;await(s=t.url,new Promise(((t,i)=>{const e=document.createElement("link");e.onload=()=>t(e),e.onerror=t=>i(t),e.rel="stylesheet",e.href=s,document.head.appendChild(e)})))}ae(){const t=[...this.Sn];if(this.Sn.clear(),!this.On)for(const s of t){const t=s.play();t&&t.catch((t=>{this.kn.has(s)||this.Sn.add(s)}))}}oe(t){if("function"!=typeof t.play)throw new Error("missing play function");let s;this.kn.delete(t);try{s=t.play()}catch(s){return void this.Sn.add(t)}s&&s.catch((s=>{this.kn.has(t)||this.Sn.add(t)}))}re(t){this.Sn.delete(t),this.kn.add(t)}ce(t){this.On=!!t}fn(){navigator.splashscreen&&navigator.splashscreen.hide&&navigator.splashscreen.hide()}rn(t){if(!t.show)return void(this.Ve&&(this.Ve.style.display="none"));this.Ve||(this.Ve=document.createElement("div"),this.Ve.id="inspectOutline",document.body.appendChild(this.Ve));const s=this.Ve;s.style.display="",s.style.left=t.left-1+"px",s.style.top=t.top-1+"px",s.style.width=t.width+2+"px",s.style.height=t.height+2+"px",s.textContent=t.name}en(){window.C3_RegisterSW&&window.C3_RegisterSW()}nn(t){window.c3_postToMessagePort&&(t.from="runtime",window.c3_postToMessagePort(t))}Hi(t,s){return this.O("js-invoke-function",{name:t,params:s})}un(t){const s=t.url,i=t.opts,e=t.port2;new Worker(s,i).postMessage({type:"construct-worker-init",port2:e},[e])}dn(t){alert(t.message)}wn(t){const s=t.type;if("create"===s){const s=document.createElement("p");s.id="c3-sr-"+t.id,s.textContent=t.text,this.Be.appendChild(s)}else if("update"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.textContent=t.text:console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else if("release"===s){const s=document.getElementById("c3-sr-"+t.id);s?s.remove():console.warn(`[Construct] Missing screen reader text with id ${t.id}`)}else console.warn(`[Construct] Unknown screen reader text update '${s}'`)}mn(t){this.je=!0;const s=document.createElement("h1");s.id="exportToVideoMessage",s.textContent=t.message,document.body.prepend(s),document.body.classList.add("exportingToVideo"),this.G().Xs().style.display="",this.h.ue(t.duration)}pn(t){this.qe=t.message,-1===this.Ne&&(this.Ne=setTimeout((()=>this.Vn()),250))}Vn(){this.Ne=-1;const t=document.getElementById("exportToVideoMessage");t&&(t.textContent=this.qe)}yn(t){window.jn({type:"exported-video",arrayBuffer:t.arrayBuffer,contentType:t.contentType,time:t.time})}gn(t){window.jn({type:"exported-image-sequence",blobArr:t.blobArr,time:t.time,gif:t.gif})}};S.ie(W)}{const U="dispatchworker.js",H="jobworker.js";self.mi=class{constructor(t){this.qn=t,this.Nn=Math.min(navigator.hardwareConcurrency||2,16),this.$n=null,this.zn=[],this.Yn=null,this.Xn=null}async pi(){if(this.Jn)throw new Error("already initialised");this.Jn=!0;const t=this.qn.Qs()+U;this.$n=await this.qn.xi(t,{name:"DispatchWorker"});const s=new MessageChannel;this.Yn=s.port1,this.$n.postMessage({type:"_init","in-port":s.port2},[s.port2]),this.Xn=await this.Xi()}async Xi(){const t=this.zn.length,s=this.qn.Qs()+H,i=await this.qn.xi(s,{name:"JobWorker"+t}),e=new MessageChannel,n=new MessageChannel;return this.$n.postMessage({type:"_addJobWorker",port:e.port1},[e.port1]),i.postMessage({type:"init",number:t,"dispatch-port":e.port2,"output-port":n.port2},[e.port2,n.port2]),this.zn.push(i),n.port1}Ci(){return{inputPort:this.Yn,outputPort:this.Xn,maxNumWorkers:this.Nn}}Fi(){return[this.Yn,this.Xn]}}}{const B="platform-info";function V(t){return new Promise(((s,i)=>{t.getInsetTop(s,i)}))}function j(t){return new Promise(((s,i)=>{t.getInsetRight(s,i)}))}function q(t){return new Promise(((s,i)=>{t.getInsetBottom(s,i)}))}function N(t){return new Promise(((s,i)=>{t.getInsetLeft(s,i)}))}const $=class extends self.i{constructor(t){super(t,B),this.A([["get-initial-state",()=>this.Kn()],["request-wake-lock",()=>this.Zn()],["release-wake-lock",()=>this.Qn()]]),window.addEventListener("resize",(()=>this.th())),this.sh=null}async Kn(){const t=await this.ih();return{screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:t,supportsWakeLock:!!navigator.wakeLock}}async ih(){const t=self.AndroidNotch;if(!t){const t=document.body,s=t.style;s.setProperty("--temp-sai-top","env(safe-area-inset-top)"),s.setProperty("--temp-sai-right","env(safe-area-inset-right)"),s.setProperty("--temp-sai-bottom","env(safe-area-inset-bottom)"),s.setProperty("--temp-sai-left","env(safe-area-inset-left)");const i=getComputedStyle(t),e=[i.getPropertyValue("--temp-sai-top"),i.getPropertyValue("--temp-sai-right"),i.getPropertyValue("--temp-sai-bottom"),i.getPropertyValue("--temp-sai-left")].map((t=>{const s=parseInt(t,10);return isFinite(s)?s:0}));return s.removeProperty("--temp-sai-top"),s.removeProperty("--temp-sai-right"),s.removeProperty("--temp-sai-bottom"),s.removeProperty("--temp-sai-left"),e}try{return await Promise.all([V(t),j(t),q(t),N(t)])}catch(t){return console.error("[Construct] Failed to get Android safe area inset: ",t),[0,0,0,0]}}async th(){const t=await this.ih();this._("window-resize",{windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,safeAreaInset:t})}async Zn(){if(!this.sh)try{this.sh=await navigator.wakeLock.request("screen"),this.sh.addEventListener("release",(()=>this.eh())),console.log("[Construct] Screen wake lock acquired"),this._("wake-lock-acquired")}catch(t){console.warn("[Construct] Failed to acquire screen wake lock: ",t),this._("wake-lock-error")}}Qn(){this.sh&&(this.sh.release(),this.sh=null)}eh(){console.log("[Construct] Screen wake lock released"),this.sh=null,this._("wake-lock-released")}};self.ss.ie($)}{const z=180/Math.PI,Y="audio";self.nh=class extends self.i{constructor(t){super(t,Y),this.hh=null,this.oh=null,this.rh=!1,this.ah=!1,this.uh=()=>this.dh(),this.wh=[],this.fh=[],this.mh=null,this.ph=[],this.yh=new Set,this.gh=-1,this.bh=new Map,this._h=1,this.On=!1,this.Sh=0,this.kh=1,this.Oh=0,this.Ph="HRTF",this.Rh="inverse",this.Ch=600,this.Mh=1e4,this.xh=1,this.Ih=[0,0,0],this.Th=[0,0,-1,0,1,0],this.Ah=!1,this.Gh=null,this.Eh=new Map,this.Fh=new Set,this.Lh=!1,this.Dh=!1,this.Wh="",this.Uh=null,self.C3Audio_OnMicrophoneStream=(t,s)=>this.Hh(t,s),this.Bh=null,self.C3Audio_GetOutputStream=()=>this.Vh(),self.C3Audio_DOMInterface=this,this.A([["create-audio-context",t=>this.jh(t)],["play",t=>this.qh(t)],["stop",t=>this.Nh(t)],["stop-all",()=>this.$h()],["set-paused",t=>this.zh(t)],["set-volume",t=>this.Yh(t)],["fade-volume",t=>this.Xh(t)],["set-master-volume",t=>this.Jh(t)],["set-muted",t=>this.Kh(t)],["set-silent",t=>this.Zh(t)],["set-looping",t=>this.Qh(t)],["set-playback-rate",t=>this.so(t)],["set-stereo-pan",t=>this.io(t)],["seek",t=>this.eo(t)],["preload",t=>this.no(t)],["unload",t=>this.ho(t)],["unload-all",()=>this.oo()],["set-suspended",t=>this.ro(t)],["add-effect",t=>this.ao(t)],["set-effect-param",t=>this.co(t)],["remove-effects",t=>this.lo(t)],["tick",t=>this.uo(t)],["load-state",t=>this.do(t)],["offline-render-audio",t=>this.wo(t)],["offline-render-finish",()=>this.fo()]])}async jh(t){if(t.usePlayMusicAsSoundWorkaround&&(this.Ah=!0),this.Sh=t.timeScaleMode,this.Ph=["equalpower","HRTF","soundfield"][t.panningModel],this.Rh=["linear","inverse","exponential"][t.distanceModel],this.Ch=t.refDistance,this.Mh=t.maxDistance,this.xh=t.rolloffFactor,this.h.Ji()){this.Ah=!0;const t=48e3;this.hh=new OfflineAudioContext({numberOfChannels:2,sampleRate:t,length:Math.ceil(this.h.de()*t)})}else this.hh=new AudioContext({latencyHint:t.latencyHint}),this.mo(),this.hh.onstatechange=()=>{"running"!==this.hh.state&&this.mo(),this._("audiocontext-state",{audioContextState:this.hh.state})};this.oh=this.hh.createGain(),this.oh.connect(this.hh.destination);const s=t.listenerPos;this.Ih[0]=s[0],this.Ih[1]=s[1],this.Ih[2]=s[2],this.hh.listener.setPosition(s[0],s[1],s[2]),this.hh.listener.setOrientation(...this.Th),self.C3_GetAudioContextCurrentTime=()=>this.po();try{await Promise.all(t.preloadList.map((t=>this.yo(t.originalUrl,t.url,t.type,!1))))}catch(t){console.error("[Construct] Preloading sounds failed: ",t)}return{sampleRate:this.hh.sampleRate,audioContextState:this.hh.state,outputLatency:this.hh.outputLatency||0}}mo(){this.ah||(this.rh=!1,window.addEventListener("pointerup",this.uh,!0),window.addEventListener("touchend",this.uh,!0),window.addEventListener("click",this.uh,!0),window.addEventListener("keydown",this.uh,!0),this.ah=!0)}vo(){this.ah&&(this.rh=!0,window.removeEventListener("pointerup",this.uh,!0),window.removeEventListener("touchend",this.uh,!0),window.removeEventListener("click",this.uh,!0),window.removeEventListener("keydown",this.uh,!0),this.ah=!1)}dh(){if(this.rh)return;const t=this.hh;"suspended"===t.state&&t.resume&&t.resume();const s=t.createBuffer(1,220,22050),i=t.createBufferSource();i.buffer=s,i.connect(t.destination),i.start(0),"running"===t.state&&this.vo()}bo(t,s){for(const i of s){let s=!1;for(const e of t)if(self.nh._o(e,i)){s=!0;break}if(!s)return!1}return!0}So(){return this.hh}po(){return this.hh.currentTime}ko(){return this.oh}GetAudioContextExtern(){return this.So()}GetDestinationNodeExtern(){return this.ko()}Oo(t){const s=this.Eh.get(t.toLowerCase());return s?s[0].Po():this.ko()}Ro(t,s){t=t.toLowerCase();let i=this.Eh.get(t);i||(i=[],this.Eh.set(t,i)),s.Co(i.length),s.Mo(t),i.push(s),this.xo(t)}xo(t){t=t.toLowerCase();let s=this.ko();const i=this.Eh.get(t);if(i&&i.length){s=i[0].Po();for(let t=0,s=i.length;t<s;++t){const e=i[t];t+1===s?e.Io(this.ko()):e.Io(i[t+1].Po())}}for(const i of this.To(t))i.Ao(s);this.Uh&&this.Wh===t&&(this.Uh.disconnect(),this.Uh.connect(s))}Go(){return this._h}Eo(){return this.On}Fo(){return this.Sh}Lo(){return this.kh}Do(){return this.Oh}Wo(){return this.Ah}Uo(){return this.Ph}Ho(){return this.Rh}Bo(){return this.Ch}Vo(){return this.Mh}jo(){return this.xh}oe(t){this.h.oe(t)}re(t){this.h.re(t)}qo(t){let s=0;for(let i=0,e=this.fh.length;i<e;++i){const e=this.fh[i];this.fh[s]=e,e.No()===t?e.et():++s}this.fh.length=s}$o(){let t=0;for(let s=0,i=this.wh.length;s<i;++s){const i=this.wh[s];this.wh[t]=i,i.zo()&&i!==this.Gh?i.et():++t}this.wh.length=t}*Yo(t){if(t.length>0)for(const s of this.fh)this.bo(s.Xo(),t)&&(yield s);else this.mh&&!this.mh.Jo()&&(yield this.mh)}*To(t){if(t)for(const s of this.fh)self.nh._o(s.Ko(),t)&&(yield s);else this.mh&&!this.mh.Jo()&&(yield this.mh)}async yo(t,s,i,e,n){for(const t of this.wh)if(t.Zo()===s)return e&&this.Ah&&(this.Gh=t),await t.Qo(),t;if(n)return null;e&&this.Ah&&this.$o();const h=self.sr.tr(this,t,s,i,e);return this.wh.push(h),e&&this.Ah&&(this.Gh=h),await h.Qo(),this.yh.has(t)||(this._("buffer-metadata",{originalUrl:t,duration:h.ir()}),this.yh.add(t)),h}async er(t,s,i,e,n){for(const t of this.fh)if(t.Zo()===s&&(t.nr()||n))return n&&this.Ah&&(this.Gh=t.No()),t.hr(e),t;const h=await this.yo(t,s,i,n);if(h.rr())throw new Error(`buffer '${t}' unloaded while loading`);const o=h.ar(e);return this.fh.push(o),o}cr(t){const s=t.join(" ");let i=this.bh.get(s);if(!i){let t=null;i={lr:0,promise:new Promise((s=>t=s)),resolve:t},this.bh.set(s,i)}i.lr++}ur(t){const s=t.join(" "),i=this.bh.get(s);if(!i)throw new Error("expected pending tag");i.lr--,0===i.lr&&(i.resolve(),this.bh.delete(s))}dr(t){const s=(0===t.length?this.ph:t).join(" "),i=this.bh.get(s);return i?i.promise:Promise.resolve()}wr(){if(this.Fh.size>0)this.L();else for(const t of this.fh)if(t.mr())return void this.L()}m(){for(const t of this.Fh)t.m();const t=this.po();for(const s of this.fh)s.m(t);const s=this.fh.filter((t=>t.mr())).map((t=>t.pr()));this._("state",{tickCount:this.gh,outputLatency:this.hh.outputLatency||0,audioInstances:s,analysers:[...this.Fh].map((t=>t.yr()))}),0===s.length&&0===this.Fh.size&&this.W()}gr(t,s,i){this._("trigger",{type:t,tags:s,aiid:i})}async qh(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic,h=t.tags,o=t.isLooping,r=t.vol,a=t.pos,c=t.panning,l=t.stereoPan;let u=t.off;if(u>0&&!t.trueClock)if(this.hh.getOutputTimestamp){const t=this.hh.getOutputTimestamp();u=u-t.performanceTime/1e3+t.contextTime}else u=u-performance.now()/1e3+this.hh.currentTime;this.ph=h.slice(0),this.cr(h);try{this.mh=await this.er(s,i,e,h,n),c?(this.mh.vr(!0),this.mh.br(c.x,c.y,c.z,c.angle,c.innerAngle,c.outerAngle,c.outerGain),c.hasOwnProperty("uid")&&this.mh._r(c.uid)):"number"==typeof l&&0!==l?(this.mh.Sr(!0),this.mh.kr(l)):(this.mh.vr(!1),this.mh.Sr(!1)),this.mh.Play(o,r,a,u)}catch(t){return void console.error("[Construct] Audio: error starting playback: ",t)}finally{this.ur(h)}this.L()}Nh(t){const s=t.tags;for(const t of this.Yo(s))t.Or()}$h(){for(const t of this.fh)t.Or()}zh(t){const s=t.tags,i=t.paused;for(const t of this.Yo(s))i?t.Pr():t.Rr();this.wr()}Yh(t){const s=t.tags,i=t.vol;for(const t of this.Yo(s))t.Cr(i)}io(t){const s=t.tags,i=t.p;for(const t of this.Yo(s))t.Sr(!0),t.kr(i)}async Xh(t){const s=t.tags,i=t.vol,e=t.duration,n=t.stopOnEnd;await this.dr(s);for(const t of this.Yo(s))t.Mr(i,e,n);this.wr()}Jh(t){this._h=t.vol,this.oh.gain.value=this._h}Kh(t){const s=t.tags,i=t.isMuted;for(const t of this.Yo(s))t.Ir(i)}Zh(t){this.On=t.isSilent,this.h.ce(this.On);for(const t of this.fh)t.Tr()}Qh(t){const s=t.tags,i=t.isLooping;for(const t of this.Yo(s))t.Ar(i)}async so(t){const s=t.tags,i=t.rate;await this.dr(s);for(const t of this.Yo(s))t.Gr(i)}async eo(t){const s=t.tags,i=t.pos;await this.dr(s);for(const t of this.Yo(s))t.Er(i)}async no(t){const s=t.originalUrl,i=t.url,e=t.type,n=t.isMusic;try{await this.er(s,i,e,"",n)}catch(t){console.error("[Construct] Audio: error preloading: ",t)}}async ho(t){const s=t.url,i=t.type,e=t.isMusic,n=await this.yo("",s,i,e,!0);if(!n)return;n.et(),this.Gh===n&&(this.Gh=null);const h=this.wh.indexOf(n);-1!==h&&this.wh.splice(h,1)}oo(){for(const t of this.wh)t.et(),this.Gh===t&&(this.Gh=null);this.wh.length=0}ro(t){const s=t.isSuspended;!s&&this.hh.resume&&this.hh.resume();for(const t of this.fh)t.Fr(s);s&&this.hh.suspend&&this.hh.suspend()}uo(t){if(this.kh=t.timeScale,this.Oh=t.gameTime,this.gh=t.tickCount,0!==this.Sh)for(const t of this.fh)t.Lr();const s=t.listenerPos;!s||this.Ih[0]===s[0]&&this.Ih[1]===s[1]&&this.Ih[2]===s[2]||(this.Ih[0]=s[0],this.Ih[1]=s[1],this.Ih[2]=s[2],this.hh.listener.setPosition(s[0],s[1],s[2]));const i=t.listenerOrientation;if(i&&(this.Th[0]!==i[0]||this.Th[1]!==i[1]||this.Th[2]!==i[2]||this.Th[3]!==i[3]||this.Th[4]!==i[4]||this.Th[5]!==i[5])){for(let t=0;t<6;++t)this.Th[t]=i[t];this.hh.listener.setOrientation(...this.Th)}for(const s of t.instPans){const t=s.uid;for(const i of this.fh)i.Dr()===t&&i.Wr(s.x,s.y,s.z,s.angle)}}async ao(t){const s=t.type,i=t.hasOwnProperty("tags")?t.tags:[t.tag],e=t.params;let n,h;if("convolution"===s)try{h=await this.yo(t.bufferOriginalUrl,t.bufferUrl,t.bufferType,!1)}catch(t){return void console.log("[Construct] Audio: error loading convolution: ",t)}for(const o of i){if("filter"===s)n=new self.Ur(this,...e);else if("delay"===s)n=new self.Hr(this,...e);else if("convolution"===s)n=new self.Br(this,h.Vr(),...e),n.jr(t.bufferOriginalUrl,t.bufferUrl,t.bufferType);else if("flanger"===s)n=new self.qr(this,...e);else if("phaser"===s)n=new self.Nr(this,...e);else if("gain"===s)n=new self.$r(this,...e);else if("stereopan"===s)n=new self.zr(this,...e);else if("tremolo"===s)n=new self.Yr(this,...e);else if("ringmod"===s)n=new self.Xr(this,...e);else if("distortion"===s)n=new self.Jr(this,...e);else if("compressor"===s)n=new self.Kr(this,...e);else{if("analyser"!==s)throw new Error("invalid effect type");n=new self.Zr(this,...e)}this.Ro(o,n)}this.Qr()}co(t){const s=t.tags,i=t.index,e=t.param,n=t.value,h=t.ramp,o=t.time;for(const t of s){const s=this.Eh.get(t.toLowerCase());!s||i<0||i>=s.length||s[i].ta(e,n,h,o)}this.Qr()}lo(t){const s=t.tags;for(const t of s){const s=t.toLowerCase(),i=this.Eh.get(s);if(!i||!i.length)return;for(const t of i)t.et();this.Eh.delete(s),this.xo(s)}}sa(t){this.Fh.add(t),this.wr()}ia(t){this.Fh.delete(t)}Qr(){this.Lh||(this.Lh=!0,Promise.resolve().then((()=>this.ea())))}ea(){const t={};for(const[s,i]of this.Eh)t[s]=i.map((t=>t.pr()));this._("fxstate",{fxstate:t}),this.Lh=!1}async do(t){const s=t.saveLoadMode;if(3!==s){const t=[];for(const i of this.fh)i.zo()&&1===s||!i.zo()&&2===s?t.push(i):i.et();this.fh=t}for(const t of this.Eh.values())for(const s of t)s.et();this.Eh.clear(),this.kh=t.timeScale,this.Oh=t.gameTime;const i=t.listenerPos;this.Ih[0]=i[0],this.Ih[1]=i[1],this.Ih[2]=i[2],this.hh.listener.setPosition(i[0],i[1],i[2]);const e=t.listenerOrientation;if(Array.isArray(e)){for(let t=0;t<6;++t)this.Th[t]=e[t];this.hh.listener.setOrientation(...this.Th)}this.On=t.isSilent,this.h.ce(this.On),this._h=t.masterVolume,this.oh.gain.value=this._h;const n=[];for(const s of Object.values(t.effects))n.push(Promise.all(s.map((t=>this.ao(t)))));await Promise.all(n),await Promise.all(t.playing.map((t=>this.na(t,s)))),this.wr()}async na(t,s){if(3===s)return;const i=t.bufferOriginalUrl,e=t.bufferUrl,n=t.bufferType,h=t.isMusic,o=t.tags,r=t.isLooping,a=t.volume,c=t.playbackTime;if(h&&1===s)return;if(!h&&2===s)return;let l=null;try{l=await this.er(i,e,n,o,h)}catch(t){return void console.error("[Construct] Audio: error loading audio state: ",t)}l.ha(t.pan),l.oa(t.stereoPan),l.Play(r,a,c,0),t.isPlaying||l.Pr(),l.ra(t)}Hh(t,s){this.Uh&&this.Uh.disconnect(),this.Wh=s.toLowerCase(),this.Uh=this.hh.createMediaStreamSource(t),this.Uh.connect(this.Oo(this.Wh))}Vh(){return this.Bh||(this.Bh=this.hh.createMediaStreamDestination(),this.oh.connect(this.Bh)),this.Bh.stream}async wo(t){try{const s=t.time,i=this.hh.suspend(s);this.Dh?this.hh.resume():(this.hh.startRendering().then((t=>this.aa(t))).catch((t=>this.ca(t))),this.Dh=!0),await i}catch(t){this.ca(t)}}fo(){this.hh.resume()}aa(t){const s=[];for(let i=0,e=t.numberOfChannels;i<e;++i){const e=t.getChannelData(i);s.push(e.buffer)}this.h.S("runtime","offline-audio-render-completed",{duration:t.duration,length:t.length,numberOfChannels:t.numberOfChannels,sampleRate:t.sampleRate,channelData:s},null,s)}ca(t){console.error("[Audio] Offline rendering error: ",t)}static _o(t,s){return t===s||t.normalize().toLowerCase()===s.normalize().toLowerCase()}static la(t){return t*z}static ua(t){return Math.pow(10,t/20)}static da(t){return Math.max(Math.min(self.nh.ua(t),1),0)}static wa(t){return Math.log(t)/Math.log(10)*20}static fa(t){return self.nh.wa(Math.max(Math.min(t,1),0))}static ma(t,s){return 1-Math.exp(-s*t)}},self.ss.ie(self.nh)}self.sr=class{constructor(t,s,i,e,n){this.pa=t,this.ya=s,this.ga=i,this.va=e,this.ba=n,this._a="",this.Sa="not-loaded",this.ka=null}et(){this.Sa="not-loaded",this.pa=null,this.ka=null}rr(){return!this.pa}static tr(t,s,i,e,n){return!n||t.Wo()?new self.Oa(t,s,i,e,n):new self.Pa(t,s,i,e,n)}ar(t){return"html5"===this._a?new self.Ra(this.pa,this,t):new self.Ca(this.pa,this,t)}Ma(){}Qo(){return this.ka||(this.ka=this.Ma()),this.ka}xa(){}Ia(){}Ta(){return"failed"===this.Sa}So(){return this.pa.So()}Aa(){return this._a}Ga(){return this.ya}Zo(){return this.ga}Ea(){return this.va}zo(){return this.ba}ir(){}},self.Pa=class extends self.sr{constructor(t,s,i,e,n){super(t,s,i,e,n),this._a="html5",this.Fa=new Audio,this.Fa.crossOrigin="anonymous",this.Fa.autoplay=!1,this.Fa.preload="auto",this.La=null,this.Da=null,this.Wa=!1,this.Fa.addEventListener("canplaythrough",(()=>this.Wa=!0)),this.Ua=this.So().createGain(),this.Ha=null,this.Fa.addEventListener("canplay",(()=>{this.La&&(this.Sa="loaded",this.La(),this.La=null,this.Da=null),!this.Ha&&this.Fa&&(this.Ha=this.So().createMediaElementSource(this.Fa),this.Ha.connect(this.Ua))})),this.onended=null,this.Fa.addEventListener("ended",(()=>{this.onended&&this.onended()})),this.Fa.addEventListener("error",(t=>this.Ba(t)))}et(){this.pa.qo(this),this.Ua.disconnect(),this.Ua=null,this.Ha.disconnect(),this.Ha=null,this.Fa&&!this.Fa.paused&&this.Fa.pause(),this.onended=null,this.Fa=null,super.et()}Ma(){return this.Sa="loading",new Promise(((t,s)=>{this.La=t,this.Da=s,this.Fa.src=this.ga}))}Ba(t){console.error(`[Construct] Audio '${this.ga}' error: `,t),this.Da&&(this.Sa="failed",this.Da(t),this.La=null,this.Da=null)}xa(){const t=this.Fa.readyState>=4;return t&&(this.Wa=!0),t||this.Wa}Ia(){return this.xa()}Va(){return this.Fa}ja(){return this.Ua}ir(){return this.Fa.duration}},self.Oa=class extends self.sr{constructor(t,s,i,e,n){super(t,s,i,e,n),this._a="webaudio",this.qa=null,this.Na=null}et(){this.pa.qo(this),this.qa=null,this.Na=null,super.et()}async $a(){if(this.qa)return this.qa;const t=this.pa.G();if("cordova"===t.Ks()&&t.fe(this.ga)&&t.Zs())this.qa=await t.Yi(this.ga);else if("playable-ad-single-file"===t.Ks()&&t.fe(this.ga)){const s=t._PlayableAdFetchBlob(this.ga);this.qa=await s.arrayBuffer()}else{const t=await fetch(this.ga);if(!t.ok)throw new Error(`error fetching audio data: ${t.status} ${t.statusText}`);this.qa=await t.arrayBuffer()}}async za(){if(this.Na)return this.Na;const t=this.pa.So();this.Na=await t.decodeAudioData(this.qa),this.qa=null}async Ma(){try{if(this.Sa="loading",await this.$a(),this.rr())return;await this.za(),this.Sa="loaded"}catch(t){this.Sa="failed",console.error(`[Construct] Failed to load audio '${this.ga}': `,t)}}xa(){return!(!this.qa&&!this.Na)}Ia(){return!!this.Na}Vr(){return this.Na}ir(){return this.Na?this.Na.duration:0}};{let X=0;self.Ya=class{constructor(t,s,i){this.pa=t,this.Xa=s,this.Ja=i,this.Ka=X++,this.Za=this.So().createGain(),this.Za.connect(this.ko()),this.Qa=null,this.tc=!1,this.sc=[0,0,0],this.ec=[0,0,0],this.nc=[0,0,0],this.hc=null,this.oc=!1,this.rc=0,this.ac=!0,this.cc=!1,this.lc=!1,this.uc=!1,this.dc=1,this.wc=!1,this.fc=1;const e=this.pa.Fo();this.mc=1===e&&!this.zo()||2===e,this.yc=-1,this.vc=-1,this.bc=!1}et(){this.pa=null,this.Xa=null,this.Qa&&(this.Qa.disconnect(),this.Qa=null),this.hc&&(this.hc.disconnect(),this.hc=null),this.Za.disconnect(),this.Za=null}So(){return this.pa.So()}hr(t){this.Ja=t}Xo(){return this.Ja}Ko(){return this.Ja.length>0?this.Ja[0]:""}ko(){return this.pa.Oo(this.Ko())}_c(){return this.mc?this.pa.Do():performance.now()/1e3}Ga(){return this.Xa.Ga()}Zo(){return this.Xa.Zo()}Ea(){return this.Xa.Ea()}No(){return this.Xa}zo(){return this.Xa.zo()}Sc(){return this.Ka}Jo(){}nr(){}IsPlaying(){return!this.ac&&!this.cc&&!this.Jo()}mr(){return!this.ac&&!this.Jo()}kc(){}ir(t){let s=this.Xa.ir();return t&&(s/=this.fc||.001),s}Play(t,s,i,e){}Or(){}Pr(){}Oc(){return this.cc}Rr(){}Cr(t){this.dc=t,this.Za.gain.cancelScheduledValues(0),this.vc=-1,this.Za.gain.value=this.Pc()}Mr(t,s,i){if(this.Rc())return;const e=this.Za.gain;e.cancelScheduledValues(0);const n=this.pa.po(),h=n+s;e.setValueAtTime(e.value,n),e.linearRampToValueAtTime(t,h),this.dc=t,this.vc=h,this.bc=i}Cc(){this.Cr(this.dc)}m(t){-1!==this.vc&&t>=this.vc&&(this.vc=-1,this.bc&&this.Or(),this.pa.gr("fade-ended",this.Ja,this.Ka))}Pc(){const t=this.dc;return isFinite(t)?t:0}Ir(t){t=!!t,this.wc!==t&&(this.wc=t,this.Tr())}Rc(){return this.wc}Eo(){return this.pa.Eo()}Tr(){}Ar(t){}Mc(){return this.uc}Gr(t){this.fc!==t&&(this.fc=t,this.Lr())}Lr(){}xc(){return this.fc}Er(t){}Fr(t){}vr(t){t=!!t,this.tc!==t&&(this.tc=t,this.tc?(this.Sr(!1),this.Qa||(this.Qa=this.So().createPanner(),this.Qa.panningModel=this.pa.Uo(),this.Qa.distanceModel=this.pa.Ho(),this.Qa.refDistance=this.pa.Bo(),this.Qa.maxDistance=this.pa.Vo(),this.Qa.rolloffFactor=this.pa.jo()),this.Za.disconnect(),this.Za.connect(this.Qa),this.Qa.connect(this.ko())):(this.Qa.disconnect(),this.Za.disconnect(),this.Za.connect(this.ko())))}br(t,s,i,e,n,h,o){if(!this.tc)return;this.Wr(t,s,i,e);const r=self.nh.la;this.nc[0]!==r(n)&&(this.nc[0]=r(n),this.Qa.coneInnerAngle=r(n)),this.nc[1]!==r(h)&&(this.nc[1]=r(h),this.Qa.coneOuterAngle=r(h)),this.nc[2]!==o&&(this.nc[2]=o,this.Qa.coneOuterGain=o)}Wr(t,s,i,e){if(!this.tc)return;const n=this.sc,h=this.ec,o=Math.cos(e),r=Math.sin(e);n[0]===t&&n[1]===s&&n[2]===i||(n[0]=t,n[1]=s,n[2]=i,this.Qa.setPosition(...n)),h[0]===o&&h[1]===r&&0===h[2]||(h[0]=o,h[1]=r,h[2]=0,this.Qa.setOrientation(...h))}Sr(t){t=!!t,this.oc!==t&&(this.oc=t,this.oc?(this.vr(!1),this.hc=this.So().createStereoPanner(),this.Za.disconnect(),this.Za.connect(this.hc),this.hc.connect(this.ko())):(this.hc.disconnect(),this.hc=null,this.Za.disconnect(),this.Za.connect(this.ko())))}kr(t){this.oc&&this.rc!==t&&(this.hc.pan.value=t,this.rc=t)}_r(t){this.yc=t}Dr(){return this.yc}Ic(){}Ao(t){const s=this.hc||this.Qa||this.Za;s.disconnect(),s.connect(t)}pr(){return{aiid:this.Sc(),tags:this.Ja,duration:this.ir(),volume:-1===this.vc?this.dc:this.Za.gain.value,isPlaying:this.IsPlaying(),playbackTime:this.kc(),playbackRate:this.xc(),uid:this.yc,bufferOriginalUrl:this.Ga(),bufferUrl:"",bufferType:this.Ea(),isMusic:this.zo(),isLooping:this.Mc(),isMuted:this.Rc(),resumePosition:this.Ic(),pan:this.Tc(),stereoPan:this.Ac()}}ra(t){this.Gr(t.playbackRate),this.Ir(t.isMuted)}Tc(){if(!this.Qa)return null;const t=this.Qa;return{pos:this.sc,orient:this.ec,cia:t.coneInnerAngle,coa:t.coneOuterAngle,cog:t.coneOuterGain,uid:this.yc}}ha(t){if(!t)return void this.vr(!1);this.vr(!0);const s=this.Qa,i=t.pos;this.sc[0]=i[0],this.sc[1]=i[1],this.sc[2]=i[2];const e=t.orient;this.ec[0]=e[0],this.ec[1]=e[1],this.ec[2]=e[2],s.setPosition(...this.sc),s.setOrientation(...this.ec),this.nc[0]=t.cia,this.nc[1]=t.coa,this.nc[2]=t.cog,s.coneInnerAngle=t.cia,s.coneOuterAngle=t.coa,s.coneOuterGain=t.cog,this.yc=t.uid}Ac(){return this.hc?this.rc:null}oa(t){"number"==typeof t?(this.Sr(!0),this.kr(t)):this.Sr(!1)}}}self.Ra=class extends self.Ya{constructor(t,s,i){super(t,s,i),this.Xa.ja().connect(this.Za),this.Xa.onended=()=>this.Gc()}et(){this.Or(),this.Xa.ja().disconnect(),super.et()}Va(){return this.Xa.Va()}Gc(){this.ac=!0,this.yc=-1,this.pa.gr("ended",this.Ja,this.Ka)}Jo(){return this.Va().ended}nr(){return!!this.ac||this.Jo()}kc(){let t=this.Va().currentTime;return this.uc||(t=Math.min(t,this.ir())),t}Play(t,s,i,e){const n=this.Va();if(1!==n.playbackRate&&(n.playbackRate=1),n.loop!==t&&(n.loop=t),this.Cr(s),this.wc=!1,n.muted&&(n.muted=!1),n.currentTime!==i)try{n.currentTime=i}catch(t){console.warn(`[Construct] Exception seeking audio '${this.Xa.Zo()}' to position '${i}': `,t)}this.pa.oe(n),this.ac=!1,this.cc=!1,this.uc=t,this.fc=1}Or(){const t=this.Va();t.paused||t.pause(),this.pa.re(t),this.ac=!0,this.cc=!1,this.yc=-1}Pr(){if(this.cc||this.ac||this.Jo())return;const t=this.Va();t.paused||t.pause(),this.pa.re(t),this.cc=!0}Rr(){!this.cc||this.ac||this.Jo()||(this.pa.oe(this.Va()),this.cc=!1)}Tr(){this.Va().muted=this.wc||this.Eo()}Ar(t){t=!!t,this.uc!==t&&(this.uc=t,this.Va().loop=t)}Lr(){let t=this.fc;this.mc&&(t*=this.pa.Lo());try{this.Va().playbackRate=t}catch(s){console.warn(`[Construct] Unable to set playback rate '${t}':`,s)}}Er(t){if(!this.ac&&!this.Jo())try{this.Va().currentTime=t}catch(s){console.warn(`[Construct] Error seeking audio to '${t}': `,s)}}Ic(){return this.kc()}Fr(t){t?this.IsPlaying()?(this.Va().pause(),this.lc=!0):this.lc=!1:this.lc&&(this.pa.oe(this.Va()),this.lc=!1)}},self.Ca=class extends self.Ya{constructor(t,s,i){super(t,s,i),this.Ec=null,this.Fc=t=>this.Gc(t),this.Lc=!0,this.Dc=null,this.Wc=0,this.Uc=0,this.Hc=0,this.Bc=1}et(){this.Or(),this.Vc(),this.Fc=null,super.et()}Vc(){this.Ec&&(this.Ec.onended=null,this.Ec.disconnect(),this.Ec.buffer=null),this.Ec=null,this.Dc=null}Gc(t){this.cc||this.lc||t.target===this.Dc&&(this.Lc=!0,this.ac=!0,this.yc=-1,this.Vc(),this.pa.gr("ended",this.Ja,this.Ka))}Jo(){return!(!this.ac&&this.Ec&&this.Ec.loop)&&!this.cc&&this.Lc}nr(){return!(this.Ec&&!this.ac)||this.Jo()}kc(){let t=0;return t=this.cc?this.Hc:this.Uc+(this._c()-this.Wc)*this.fc,this.uc||(t=Math.min(t,this.ir())),t}Play(t,s,i,e){this.wc=!1,this.Bc=1,this.Cr(s),this.Vc(),this.Ec=this.So().createBufferSource(),this.Ec.buffer=this.Xa.Vr(),this.Ec.connect(this.Za),this.Dc=this.Ec,this.Ec.onended=this.Fc,this.Ec.loop=t,this.Ec.start(e,i),this.Lc=!1,this.ac=!1,this.cc=!1,this.uc=t,this.fc=1,this.Wc=this._c(),this.Uc=i}Or(){if(this.Ec)try{this.Ec.stop(0)}catch(t){}this.ac=!0,this.cc=!1,this.yc=-1}Pr(){this.cc||this.ac||this.Jo()||(this.Hc=this.kc(),this.uc&&(this.Hc%=this.ir()),this.cc=!0,this.Ec.stop(0))}Rr(){!this.cc||this.ac||this.Jo()||(this.Vc(),this.Ec=this.So().createBufferSource(),this.Ec.buffer=this.Xa.Vr(),this.Ec.connect(this.Za),this.Dc=this.Ec,this.Ec.onended=this.Fc,this.Ec.loop=this.uc,this.Cc(),this.Lr(),this.Ec.start(0,this.Hc),this.Wc=this._c(),this.Uc=this.Hc,this.cc=!1)}Pc(){return super.Pc()*this.Bc}Tr(){this.Bc=this.wc||this.Eo()?0:1,this.Cc()}Ar(t){t=!!t,this.uc!==t&&(this.uc=t,this.Ec&&(this.Ec.loop=t))}Lr(){let t=this.fc;this.mc&&(t*=this.pa.Lo()),this.Ec&&(this.Ec.playbackRate.value=t)}Er(t){this.ac||this.Jo()||(this.cc?this.Hc=t:(this.Pr(),this.Hc=t,this.Rr()))}Ic(){return this.Hc}Fr(t){t?this.IsPlaying()?(this.lc=!0,this.Hc=this.kc(),this.uc&&(this.Hc%=this.ir()),this.Ec.stop(0)):this.lc=!1:this.lc&&(this.Vc(),this.Ec=this.So().createBufferSource(),this.Ec.buffer=this.Xa.Vr(),this.Ec.connect(this.Za),this.Dc=this.Ec,this.Ec.onended=this.Fc,this.Ec.loop=this.uc,this.Cc(),this.Lr(),this.Ec.start(0,this.Hc),this.Wc=this._c(),this.Uc=this.Hc,this.lc=!1)}ra(t){super.ra(t),this.Hc=t.resumePosition}};{class J{constructor(t){this.pa=t,this.hh=t.So(),this.jc=-1,this.qc="",this.va="",this.Nc=null}et(){this.hh=null}Co(t){this.jc=t}$c(){return this.jc}Mo(t){this.qc=t}zc(){return this.qc}Yc(){return this.hh.createGain()}Po(){}Io(t){}Xc(t,s,i,e){if(t.cancelScheduledValues(0),0===e)return void(t.value=s);const n=this.hh.currentTime;switch(e+=n,i){case 0:t.setValueAtTime(s,e);break;case 1:t.setValueAtTime(t.value,n),t.linearRampToValueAtTime(s,e);break;case 2:t.setValueAtTime(t.value,n),t.exponentialRampToValueAtTime(s,e)}}pr(){return{type:this.va,tag:this.qc,params:this.Nc}}}self.Ur=class extends J{constructor(t,s,i,e,n,h,o){super(t),this.va="filter",this.Nc=[s,i,e,n,h,o],this.Jc=this.Yc(),this.Kc=this.Yc(),this.Kc.gain.value=o,this.Zc=this.Yc(),this.Zc.gain.value=1-o,this.Qc=this.hh.createBiquadFilter(),this.Qc.type=s,this.Qc.frequency.value=i,this.Qc.detune.value=e,this.Qc.Q.value=n,this.Qc.gain.vlaue=h,this.Jc.connect(this.Qc),this.Jc.connect(this.Zc),this.Qc.connect(this.Kc)}et(){this.Jc.disconnect(),this.Qc.disconnect(),this.Kc.disconnect(),this.Zc.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[5]=s,this.Xc(this.Kc.gain,s,i,e),this.Xc(this.Zc.gain,1-s,i,e);break;case 1:this.Nc[1]=s,this.Xc(this.Qc.frequency,s,i,e);break;case 2:this.Nc[2]=s,this.Xc(this.Qc.detune,s,i,e);break;case 3:this.Nc[3]=s,this.Xc(this.Qc.Q,s,i,e);break;case 4:this.Nc[4]=s,this.Xc(this.Qc.gain,s,i,e)}}},self.Hr=class extends J{constructor(t,s,i,e){super(t),this.va="delay",this.Nc=[s,i,e],this.Jc=this.Yc(),this.Kc=this.Yc(),this.Kc.gain.value=e,this.Zc=this.Yc(),this.Zc.gain.value=1-e,this.tl=this.Yc(),this.sl=this.hh.createDelay(s),this.sl.delayTime.value=s,this.il=this.Yc(),this.il.gain.value=i,this.Jc.connect(this.tl),this.Jc.connect(this.Zc),this.tl.connect(this.Kc),this.tl.connect(this.sl),this.sl.connect(this.il),this.il.connect(this.tl)}et(){this.Jc.disconnect(),this.Kc.disconnect(),this.Zc.disconnect(),this.tl.disconnect(),this.sl.disconnect(),this.il.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){const n=self.nh.da;switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[2]=s,this.Xc(this.Kc.gain,s,i,e),this.Xc(this.Zc.gain,1-s,i,e);break;case 4:this.Nc[1]=n(s),this.Xc(this.il.gain,n(s),i,e);break;case 5:this.Nc[0]=s,this.Xc(this.sl.delayTime,s,i,e)}}},self.Br=class extends J{constructor(t,s,i,e){super(t),this.va="convolution",this.Nc=[i,e],this.el="",this.nl="",this.hl="",this.Jc=this.Yc(),this.Kc=this.Yc(),this.Kc.gain.value=e,this.Zc=this.Yc(),this.Zc.gain.value=1-e,this.ol=this.hh.createConvolver(),this.ol.normalize=i,this.ol.buffer=s,this.Jc.connect(this.ol),this.Jc.connect(this.Zc),this.ol.connect(this.Kc)}et(){this.Jc.disconnect(),this.ol.disconnect(),this.Kc.disconnect(),this.Zc.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.Nc[1]=s,this.Xc(this.Kc.gain,s,i,e),this.Xc(this.Zc.gain,1-s,i,e))}jr(t,s,i){this.el=t,this.nl=s,this.hl=i}pr(){const t=super.pr();return t.bufferOriginalUrl=this.el,t.bufferUrl="",t.bufferType=this.hl,t}},self.qr=class extends J{constructor(t,s,i,e,n,h){super(t),this.va="flanger",this.Nc=[s,i,e,n,h],this.Jc=this.Yc(),this.Zc=this.Yc(),this.Zc.gain.value=1-h/2,this.Kc=this.Yc(),this.Kc.gain.value=h/2,this.rl=this.Yc(),this.rl.gain.value=n,this.sl=this.hh.createDelay(s+i),this.sl.delayTime.value=s,this.al=this.hh.createOscillator(),this.al.frequency.value=e,this.cl=this.Yc(),this.cl.gain.value=i,this.Jc.connect(this.sl),this.Jc.connect(this.Zc),this.sl.connect(this.Kc),this.sl.connect(this.rl),this.rl.connect(this.sl),this.al.connect(this.cl),this.cl.connect(this.sl.delayTime),this.al.start(0)}et(){this.al.stop(0),this.Jc.disconnect(),this.sl.disconnect(),this.al.disconnect(),this.cl.disconnect(),this.Zc.disconnect(),this.Kc.disconnect(),this.rl.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[4]=s,this.Xc(this.Kc.gain,s/2,i,e),this.Xc(this.Zc.gain,1-s/2,i,e);break;case 6:this.Nc[1]=s/1e3,this.Xc(this.cl.gain,s/1e3,i,e);break;case 7:this.Nc[2]=s,this.Xc(this.al.frequency,s,i,e);break;case 8:this.Nc[3]=s/100,this.Xc(this.rl.gain,s/100,i,e)}}},self.Nr=class extends J{constructor(t,s,i,e,n,h,o){super(t),this.va="phaser",this.Nc=[s,i,e,n,h,o],this.Jc=this.Yc(),this.Zc=this.Yc(),this.Zc.gain.value=1-o/2,this.Kc=this.Yc(),this.Kc.gain.value=o/2,this.Qc=this.hh.createBiquadFilter(),this.Qc.type="allpass",this.Qc.frequency.value=s,this.Qc.detune.value=i,this.Qc.Q.value=e,this.al=this.hh.createOscillator(),this.al.frequency.value=h,this.cl=this.Yc(),this.cl.gain.value=n,this.Jc.connect(this.Qc),this.Jc.connect(this.Zc),this.Qc.connect(this.Kc),this.al.connect(this.cl),this.cl.connect(this.Qc.frequency),this.al.start(0)}et(){this.al.stop(0),this.Jc.disconnect(),this.Qc.disconnect(),this.al.disconnect(),this.cl.disconnect(),this.Zc.disconnect(),this.Kc.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[5]=s,this.Xc(this.Kc.gain,s/2,i,e),this.Xc(this.Zc.gain,1-s/2,i,e);break;case 1:this.Nc[0]=s,this.Xc(this.Qc.frequency,s,i,e);break;case 2:this.Nc[1]=s,this.Xc(this.Qc.detune,s,i,e);break;case 3:this.Nc[2]=s,this.Xc(this.Qc.Q,s,i,e);break;case 6:this.Nc[3]=s,this.Xc(this.cl.gain,s,i,e);break;case 7:this.Nc[4]=s,this.Xc(this.al.frequency,s,i,e)}}},self.$r=class extends J{constructor(t,s){super(t),this.va="gain",this.Nc=[s],this.ll=this.Yc(),this.ll.gain.value=s}et(){this.ll.disconnect(),super.et()}Io(t){this.ll.disconnect(),this.ll.connect(t)}Po(){return this.ll}ta(t,s,i,e){const n=self.nh.da;4===t&&(this.Nc[0]=n(s),this.Xc(this.ll.gain,n(s),i,e))}},self.zr=class extends J{constructor(t,s){super(t),this.va="stereopan",this.Nc=[s],this.ll=this.hh.createStereoPanner(),this.ll.pan.value=s}et(){this.ll.disconnect(),super.et()}Io(t){this.ll.disconnect(),this.ll.connect(t)}Po(){return this.ll}ta(t,s,i,e){s=Math.min(Math.max(s/100,-1),1),9===t&&(this.Nc[0]=s,this.Xc(this.ll.pan,s,i,e))}},self.Yr=class extends J{constructor(t,s,i){super(t),this.va="tremolo",this.Nc=[s,i],this.ll=this.Yc(),this.ll.gain.value=1-i/2,this.al=this.hh.createOscillator(),this.al.frequency.value=s,this.cl=this.Yc(),this.cl.gain.value=i/2,this.al.connect(this.cl),this.cl.connect(this.ll.gain),this.al.start(0)}et(){this.al.stop(0),this.al.disconnect(),this.cl.disconnect(),this.ll.disconnect(),super.et()}Io(t){this.ll.disconnect(),this.ll.connect(t)}Po(){return this.ll}ta(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[1]=s,this.Xc(this.ll.gain,1-s/2,i,e),this.Xc(this.cl.gain,s/2,i,e);break;case 7:this.Nc[0]=s,this.Xc(this.al.frequency,s,i,e)}}},self.Xr=class extends J{constructor(t,s,i){super(t),this.va="ringmod",this.Nc=[s,i],this.Jc=this.Yc(),this.Kc=this.Yc(),this.Kc.gain.value=i,this.Zc=this.Yc(),this.Zc.gain.value=1-i,this.ul=this.Yc(),this.ul.gain.value=0,this.al=this.hh.createOscillator(),this.al.frequency.value=s,this.al.connect(this.ul.gain),this.al.start(0),this.Jc.connect(this.ul),this.Jc.connect(this.Zc),this.ul.connect(this.Kc)}et(){this.al.stop(0),this.al.disconnect(),this.ul.disconnect(),this.Jc.disconnect(),this.Kc.disconnect(),this.Zc.disconnect(),super.et()}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){switch(t){case 0:s=Math.max(Math.min(s/100,1),0),this.Nc[1]=s,this.Xc(this.Kc.gain,s,i,e),this.Xc(this.Zc.gain,1-s,i,e);break;case 7:this.Nc[0]=s,this.Xc(this.al.frequency,s,i,e)}}},self.Jr=class extends J{constructor(t,s,i,e,n,h){super(t),this.va="distortion",this.Nc=[s,i,e,n,h],this.Jc=this.Yc(),this.dl=this.Yc(),this.wl=this.Yc(),this.fl(e,n),this.Kc=this.Yc(),this.Kc.gain.value=h,this.Zc=this.Yc(),this.Zc.gain.value=1-h,this.ml=this.hh.createWaveShaper(),this.pl=new Float32Array(65536),this.yl(s,i),this.ml.curve=this.pl,this.Jc.connect(this.dl),this.Jc.connect(this.Zc),this.dl.connect(this.ml),this.ml.connect(this.wl),this.wl.connect(this.Kc)}et(){this.Jc.disconnect(),this.dl.disconnect(),this.ml.disconnect(),this.wl.disconnect(),this.Kc.disconnect(),this.Zc.disconnect(),super.et()}fl(t,s){t<.01&&(t=.01),this.dl.gain.value=t,this.wl.gain.value=Math.pow(1/t,.6)*s}yl(t,s){const i=32768;for(let e=0;e<i;++e){let n=e/i;n=this.gl(n,t,s),this.pl[i+e]=n,this.pl[i-e-1]=-n}}gl(t,s,i){const e=1.05*i*s-s,n=t<0?-1:1,h=t<0?-t:t;let o=h<s?h:s+e*self.nh.ma(h-s,1/e);return o*=n,o}Io(t){this.Kc.disconnect(),this.Kc.connect(t),this.Zc.disconnect(),this.Zc.connect(t)}Po(){return this.Jc}ta(t,s,i,e){0===t&&(s=Math.max(Math.min(s/100,1),0),this.Nc[4]=s,this.Xc(this.Kc.gain,s,i,e),this.Xc(this.Zc.gain,1-s,i,e))}},self.Kr=class extends J{constructor(t,s,i,e,n,h){super(t),this.va="compressor",this.Nc=[s,i,e,n,h],this.ll=this.hh.createDynamicsCompressor(),this.ll.threshold.value=s,this.ll.knee.value=i,this.ll.ratio.value=e,this.ll.attack.value=n,this.ll.release.value=h}et(){this.ll.disconnect(),super.et()}Io(t){this.ll.disconnect(),this.ll.connect(t)}Po(){return this.ll}ta(t,s,i,e){}},self.Zr=class extends J{constructor(t,s,i){super(t),this.va="analyser",this.Nc=[s,i],this.ll=this.hh.createAnalyser(),this.ll.fftSize=s,this.ll.smoothingTimeConstant=i,this.vl=new Float32Array(this.ll.frequencyBinCount),this.bl=new Uint8Array(s),this._l=0,this.Sl=0,this.pa.sa(this)}et(){this.pa.ia(this),this.ll.disconnect(),super.et()}m(){this.ll.getFloatFrequencyData(this.vl),this.ll.getByteTimeDomainData(this.bl);const t=this.ll.fftSize;this._l=0;let s=0;for(let i=0;i<t;++i){let t=(this.bl[i]-128)/128;t<0&&(t=-t),this._l<t&&(this._l=t),s+=t*t}const i=self.nh.fa;this._l=i(this._l),this.Sl=i(Math.sqrt(s/t))}Io(t){this.ll.disconnect(),this.ll.connect(t)}Po(){return this.ll}ta(t,s,i,e){}yr(){return{tag:this.zc(),index:this.$c(),peak:this._l,rms:this.Sl,binCount:this.ll.frequencyBinCount,freqBins:this.vl}}}}{let K=null,Z=null;function Q(t,s){if(t){if(s)return Array.from(document.querySelectorAll(t));{const s=document.querySelector(t);return s?[s]:[]}}return[document.documentElement]}function tt(){}window.addEventListener("beforeinstallprompt",(t=>(t.preventDefault(),K=t,Z&&Z.kl(),!1)));const st="browser",it=class extends self.i{constructor(t){super(t,st),this.Ts="",this.A([["get-initial-state",t=>this.Kn(t)],["ready-for-sw-messages",()=>this.Ol()],["alert",t=>this.dn(t)],["close",()=>this.Pl()],["set-focus",t=>this.At(t)],["vibrate",t=>this.Rl(t)],["lock-orientation",t=>this.Cl(t)],["unlock-orientation",()=>this.Ml()],["navigate",t=>this.xl(t)],["request-fullscreen",t=>this.Il(t)],["exit-fullscreen",()=>this.Tl()],["set-hash",t=>this.Al(t)],["set-document-css-style",t=>this.Gl(t)],["get-document-css-style",t=>this.El(t)],["set-window-size",t=>this.Fl(t)],["set-window-position",t=>this.Ll(t)],["request-install",()=>this.Dl()],["set-warn-on-close",t=>this.Wl(t)]]),window.addEventListener("online",(()=>this.Ul(!0))),window.addEventListener("offline",(()=>this.Ul(!1))),window.addEventListener("hashchange",(()=>this.Hl())),this.Bl=t=>t.preventDefault(),document.addEventListener("backbutton",(()=>this.Vl()))}v(){K?this.kl():Z=this,window.addEventListener("appinstalled",(()=>this.jl()))}Kn(t){return this.Ts=t.exportType,{location:location.toString(),isOnline:!!navigator.onLine,referrer:document.referrer,title:document.title,isCookieEnabled:!!navigator.cookieEnabled,screenWidth:screen.width,screenHeight:screen.height,windowOuterWidth:window.outerWidth,windowOuterHeight:window.outerHeight,isConstructArcade:void 0!==window.is_scirra_arcade,windowHasFocus:document.hasFocus()}}Ol(){window.C3_RegisterSW&&window.OfflineClientInfo&&window.OfflineClientInfo.SetMessageCallback((t=>this._("sw-message",t.data)))}kl(){this._("install-available")}async Dl(){if(!K)return{result:"unavailable"};try{return K.prompt(),{result:(await K.userChoice).outcome}}catch(t){return console.error("[Construct] Requesting install failed: ",t),{result:"failed"}}}jl(){this._("app-installed")}Ul(t){this._("online-state",{isOnline:t})}Vl(){this._("backbutton")}ql(){return"nwjs"===this.Ts?nw.Window.get():null}dn(t){alert(t.message)}Pl(){navigator.app&&navigator.app.exitApp?navigator.app.exitApp():navigator.device&&navigator.device.exitApp?navigator.device.exitApp():self.nw?self.nw.App.quit():window.close()}At(t){const s=t.isFocus;if("nwjs"===this.Ts){const t=this.ql();s?t.focus():t.blur()}else s?window.focus():window.blur()}Rl(t){navigator.vibrate&&navigator.vibrate(t.pattern)}Cl(t){const s=t.orientation;if(screen.orientation&&screen.orientation.lock)screen.orientation.lock(s).catch((t=>console.warn("[Construct] Failed to lock orientation: ",t)));else try{let t=!1;screen.lockOrientation?t=screen.lockOrientation(s):screen.webkitLockOrientation?t=screen.webkitLockOrientation(s):screen.mozLockOrientation?t=screen.mozLockOrientation(s):screen.msLockOrientation&&(t=screen.msLockOrientation(s)),t||console.warn("[Construct] Failed to lock orientation")}catch(t){console.warn("[Construct] Failed to lock orientation: ",t)}}Ml(){try{screen.orientation&&screen.orientation.unlock?screen.orientation.unlock():screen.unlockOrientation?screen.unlockOrientation():screen.webkitUnlockOrientation?screen.webkitUnlockOrientation():screen.mozUnlockOrientation?screen.mozUnlockOrientation():screen.msUnlockOrientation&&screen.msUnlockOrientation()}catch(t){}}xl(t){const s=t.type;if("back"===s)navigator.app&&navigator.app.backHistory?navigator.app.backHistory():window.history.back();else if("forward"===s)window.history.forward();else if("reload"===s)location.reload();else if("url"===s){const s=t.url,i=t.target,e=t.exportType;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):"preview"===e||"macos-wkwebiew"===e||"linux-cef"===e||this.h.Fs()?window.open(s,"_blank"):this.Nl||(2===i?window.top.location=s:1===i?window.parent.location=s:window.location=s)}else if("new-window"===s){const s=t.url,i=t.tag;self.cordova&&self.cordova.InAppBrowser?self.cordova.InAppBrowser.open(s,"_system"):window.open(s,i)}}Il(t){if(this.h.Fs()||"macos-wkwebview"===this.Ts||"linux-cef"===this.Ts)self.ss.ee(!0),this.h.ai({type:"set-fullscreen",fullscreen:!0});else{const s={navigationUI:"auto"},i=t.navUI;1===i?s.navigationUI="hide":2===i&&(s.navigationUI="show");const e=document.documentElement;let n;e.requestFullscreen?n=e.requestFullscreen(s):e.mozRequestFullScreen?n=e.mozRequestFullScreen(s):e.msRequestFullscreen?n=e.msRequestFullscreen(s):e.webkitRequestFullScreen&&(n=void 0!==Element.ALLOW_KEYBOARD_INPUT?e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT):e.webkitRequestFullScreen()),n instanceof Promise&&n.catch(tt)}}Tl(){if(this.h.Fs()||"macos-wkwebview"===this.Ts||"linux-cef"===this.Ts)self.ss.ee(!1),this.h.ai({type:"set-fullscreen",fullscreen:!1});else{let t;document.exitFullscreen?t=document.exitFullscreen():document.mozCancelFullScreen?t=document.mozCancelFullScreen():document.msExitFullscreen?t=document.msExitFullscreen():document.webkitCancelFullScreen&&(t=document.webkitCancelFullScreen()),t instanceof Promise&&t.catch(tt)}}Al(t){location.hash=t.hash}Hl(){this._("hashchange",{location:location.toString()})}Gl(t){const s=t.prop,i=t.value,e=t.selector,n=t["is-all"];try{const t=Q(e,n);for(const e of t)s.startsWith("--")?e.style.setProperty(s,i):e.style[s]=i}catch(t){console.warn("[Browser] Failed to set style: ",t)}}El(t){const s=t.prop,i=t.selector;try{const t=document.querySelector(i);return t?{isOk:!0,result:window.getComputedStyle(t).getPropertyValue(s)}:{isOk:!1}}catch(t){return console.warn("[Browser] Failed to get style: ",t),{isOk:!1}}}Fl(t){window.resizeTo(t.windowWidth,t.windowHeight)}Ll(t){window.moveTo(t.windowX,t.windowY)}Wl(t){t.enabled?window.addEventListener("beforeunload",this.Bl):window.removeEventListener("beforeunload",this.Bl)}};self.ss.ie(it)}{const et="touch",nt=class extends self.i{constructor(t){super(t,et),this.I("request-permission",(t=>this.$l(t)))}async $l(t){const s=t.type;let i=!0;0===s?i=await this.zl():1===s&&(i=await this.Yl()),this._("permission-result",{type:s,result:i})}async zl(){if(!self.DeviceOrientationEvent||!self.DeviceOrientationEvent.requestPermission)return!0;try{return"granted"===await self.DeviceOrientationEvent.requestPermission()}catch(t){return console.warn("[Touch] Failed to request orientation permission: ",t),!1}}async Yl(){if(!self.DeviceMotionEvent||!self.DeviceMotionEvent.requestPermission)return!0;try{return"granted"===await self.DeviceMotionEvent.requestPermission()}catch(t){return console.warn("[Touch] Failed to request motion permission: ",t),!1}}};self.ss.ie(nt)}{const ht="localstorage",ot=class extends self.i{constructor(t){super(t,ht),this.A([["init",()=>this.Ns()],["request-persistent",()=>this.Xl()]])}async Ns(){let t=!1;try{t=await navigator.storage.persisted()}catch(s){t=!1,console.warn("[Construct] Error checking storage persisted state: ",s)}return{isPersistent:t}}async Xl(){try{return{isOk:!0,isPersistent:await navigator.storage.persist()}}catch(t){return console.error("[Construct] Error requesting persistent storage: ",t),{isOk:!1}}}};self.ss.ie(ot)}{const rt="button";function at(t){t.stopPropagation()}const ct=class extends self.Ot{constructor(t){super(t,rt)}Ht(t,s){const i=document.createElement("input"),e=s.isCheckbox;let n=i;if(e){i.type="checkbox";const t=document.createElement("label");t.appendChild(i),t.appendChild(document.createTextNode("")),t.style.fontFamily="sans-serif",t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.display="inline-block",t.style.color="black",n=t}else i.type="button";return n.style.position="absolute",n.addEventListener("pointerdown",at),n.addEventListener("pointerrawupdate",at),n.addEventListener("pointerup",at),n.addEventListener("mousedown",at),n.addEventListener("mouseup",at),n.addEventListener("keydown",at),n.addEventListener("keyup",at),n.addEventListener("contextmenu",(t=>t.preventDefault())),i.addEventListener("click",(()=>this.Yt("click",t,{isChecked:i.checked}))),s.id&&(i.id=s.id),s.className&&(i.className=s.className),this.Zt(n,s),n}Jl(t){return"input"===t.tagName.toLowerCase()?t:t.firstChild}Bt(t){return this.Jl(t)}Zt(t,s){const i=this.Jl(t);i.checked=s.isChecked,i.disabled=!s.isEnabled,t.title=s.title,t===i?i.value=s.text:t.lastChild.textContent=s.text}};self.ss.ie(ct)}if(window.C3_Is_Supported){const lt=!1;window.c3_runtimeInterface=new self.ss({ns:lt,Mi:"workermain.js",Ai:["scripts/c3main.js"],ls:"scripts/",As:"html5"})}